2021-11-09 19:09:28.826580 (MainThread): Running with dbt=0.21.0
2021-11-09 19:09:29.866580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 19:09:29.876580 (MainThread): Tracking: tracking
2021-11-09 19:09:29.877580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C49CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C42BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C49B48>]}
2021-11-09 19:09:29.898580 (MainThread): Partial parsing not enabled
2021-11-09 19:09:29.997580 (MainThread): Parsing macros\adapters.sql
2021-11-09 19:09:30.040580 (MainThread): Parsing macros\catalog.sql
2021-11-09 19:09:30.050580 (MainThread): Parsing macros\etc.sql
2021-11-09 19:09:30.053580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 19:09:30.057580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 19:09:30.082580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 19:09:30.086580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 19:09:30.089580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 19:09:30.108580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 19:09:30.112580 (MainThread): Parsing macros\core.sql
2021-11-09 19:09:30.118580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 19:09:30.217580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 19:09:30.230580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 19:09:30.232580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 19:09:30.237580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 19:09:30.242580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 19:09:30.244580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 19:09:30.246580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 19:09:30.249580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 19:09:30.265580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 19:09:30.278580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 19:09:30.308580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 19:09:30.311580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 19:09:30.329580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 19:09:30.360580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 19:09:30.404580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 19:09:30.458580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 19:09:30.460580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 19:09:30.490580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 19:09:30.507580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 19:09:30.514580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 19:09:30.526580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 19:09:30.529580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 19:09:30.532580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 19:09:30.536580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 19:09:30.889580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 19:09:30.911580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 19:09:30.988580 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle-shop.example

2021-11-09 19:09:30.996580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '371df0ac-13bd-454c-9e4a-30a084473457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086B9A48>]}
2021-11-09 19:09:31.014580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '371df0ac-13bd-454c-9e4a-30a084473457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000878E988>]}
2021-11-09 19:09:31.015580 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 19:09:31.017580 (MainThread): 
2021-11-09 19:09:31.017580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 19:09:31.019580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 19:09:31.020580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 19:09:31.726580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbt-tutorial-331521_dbt_brooke".
2021-11-09 19:09:31.727580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbt-tutorial-331521_dbt_brooke".
2021-11-09 19:09:31.727580 (ThreadPoolExecutor-0_0): Creating schema "dbt-tutorial-331521.dbt_brooke".
2021-11-09 19:09:31.727580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-09 19:09:31.734580 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 19:09:32.536580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 19:09:32.537580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 19:09:32.544580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 19:09:33.093580 (MainThread): 13:09:33 | Concurrency: 1 threads (target='dev')
2021-11-09 19:09:33.094580 (MainThread): 13:09:33 | 
2021-11-09 19:09:33.124580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 19:09:33.125580 (Thread-1): 13:09:33 | 1 of 2 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 19:09:33.127580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 19:09:33.129580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 19:09:33.141580 (Thread-1): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58449), raddr=('142.251.32.10', 443)>
2021-11-09 19:09:33.142580 (Thread-1): unclosed <socket.socket fd=692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58450), raddr=('142.250.190.10', 443)>
2021-11-09 19:09:33.157580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 19:09:33.190580 (Thread-1): finished collecting timing info
2021-11-09 19:09:33.277580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 19:09:33.298580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 19:09:33.309580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 19:09:36.133580 (Thread-1): finished collecting timing info
2021-11-09 19:09:36.134580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '371df0ac-13bd-454c-9e4a-30a084473457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087A7C88>]}
2021-11-09 19:09:36.134580 (Thread-1): 13:09:36 | 1 of 2 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.01s]
2021-11-09 19:09:36.136580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 19:09:36.137580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 19:09:36.138580 (Thread-1): 13:09:36 | 2 of 2 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 19:09:36.139580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 19:09:36.139580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 19:09:36.140580 (Thread-1): unclosed <socket.socket fd=856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58457), raddr=('142.251.32.10', 443)>
2021-11-09 19:09:36.140580 (Thread-1): unclosed <socket.socket fd=868, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58458), raddr=('142.250.190.10', 443)>
2021-11-09 19:09:36.144580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 19:09:36.150580 (Thread-1): finished collecting timing info
2021-11-09 19:09:36.179580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 19:09:36.184580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 19:09:36.190580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 19:09:37.433580 (Thread-1): finished collecting timing info
2021-11-09 19:09:37.434580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '371df0ac-13bd-454c-9e4a-30a084473457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008830F48>]}
2021-11-09 19:09:37.434580 (Thread-1): 13:09:37 | 2 of 2 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.29s]
2021-11-09 19:09:37.435580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 19:09:37.530580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 19:09:37.531580 (MainThread): 13:09:37 | 
2021-11-09 19:09:37.531580 (MainThread): 13:09:37 | Finished running 1 table model, 1 view model in 6.51s.
2021-11-09 19:09:37.532580 (MainThread): Connection 'master' was properly closed.
2021-11-09 19:09:37.532580 (MainThread): Connection 'create_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 19:09:37.532580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 19:09:37.532580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 19:09:37.533580 (MainThread): unclosed <socket.socket fd=924, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58459), raddr=('142.251.32.10', 443)>
2021-11-09 19:09:37.534580 (MainThread): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 58460), raddr=('142.250.190.10', 443)>
2021-11-09 19:09:37.544580 (MainThread): 
2021-11-09 19:09:37.545580 (MainThread): Completed successfully
2021-11-09 19:09:37.547580 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-09 19:09:37.550580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000089C63C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008826E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087B11C8>]}
2021-11-09 19:09:37.550580 (MainThread): Flushing usage events
2021-11-09 19:59:58.211580 (MainThread): Running with dbt=0.21.0
2021-11-09 19:59:59.414580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 19:59:59.417580 (MainThread): Tracking: tracking
2021-11-09 19:59:59.417580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863DB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004410448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863DA48>]}
2021-11-09 19:59:59.439580 (MainThread): Partial parsing not enabled
2021-11-09 19:59:59.543580 (MainThread): Parsing macros\adapters.sql
2021-11-09 19:59:59.590580 (MainThread): Parsing macros\catalog.sql
2021-11-09 19:59:59.600580 (MainThread): Parsing macros\etc.sql
2021-11-09 19:59:59.604580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 19:59:59.609580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 19:59:59.634580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 19:59:59.640580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 19:59:59.643580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 19:59:59.662580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 19:59:59.666580 (MainThread): Parsing macros\core.sql
2021-11-09 19:59:59.675580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 19:59:59.785580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 19:59:59.801580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 19:59:59.805580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 19:59:59.807580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 19:59:59.811580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 19:59:59.815580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 19:59:59.816580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 19:59:59.821580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 19:59:59.840580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 19:59:59.852580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 19:59:59.878580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 19:59:59.881580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 19:59:59.901580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 19:59:59.935580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 19:59:59.985580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:00:00.046580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:00:00.050580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:00:00.082580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:00:00.096580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:00:00.106580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:00:00.122580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:00:00.126580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:00:00.128580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:00:00.131580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:00:00.597580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:00:00.623580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:00:00.631580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:00:00.723580 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle-shop.example

2021-11-09 20:00:00.736580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab59c8a3-cdb8-4478-b40b-355fb59f84c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008631CC8>]}
2021-11-09 20:00:00.759580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab59c8a3-cdb8-4478-b40b-355fb59f84c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008706888>]}
2021-11-09 20:00:00.760580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:00:00.762580 (MainThread): 
2021-11-09 20:00:00.762580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:00:00.764580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:00:00.765580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:00:01.532580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:00:01.534580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:00:01.542580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:00:02.097580 (MainThread): 14:00:02 | Concurrency: 1 threads (target='dev')
2021-11-09 20:00:02.098580 (MainThread): 14:00:02 | 
2021-11-09 20:00:02.113580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:00:02.114580 (Thread-1): 14:00:02 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:00:02.115580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:00:02.115580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:00:02.119580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:00:02.127580 (Thread-1): finished collecting timing info
2021-11-09 20:00:02.182580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:00:02.192580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:00:02.199580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-09 20:00:03.556580 (Thread-1): finished collecting timing info
2021-11-09 20:00:03.557580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab59c8a3-cdb8-4478-b40b-355fb59f84c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008706648>]}
2021-11-09 20:00:03.559580 (Thread-1): 14:00:03 | 1 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.44s]
2021-11-09 20:00:03.561580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:00:03.561580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:00:03.562580 (Thread-1): 14:00:03 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:00:03.573580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:00:03.575580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:00:03.585580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:00:03.601580 (Thread-1): finished collecting timing info
2021-11-09 20:00:03.660580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:00:03.676580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:00:04.324580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:00:04.329580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:00:07.788580 (Thread-1): finished collecting timing info
2021-11-09 20:00:07.789580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab59c8a3-cdb8-4478-b40b-355fb59f84c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008AF4F88>]}
2021-11-09 20:00:07.790580 (Thread-1): 14:00:07 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.22s]
2021-11-09 20:00:07.792580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:00:07.793580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:00:07.793580 (Thread-1): 14:00:07 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:00:07.795580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:00:07.796580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:00:07.800580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:00:07.804580 (Thread-1): finished collecting timing info
2021-11-09 20:00:07.807580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:00:07.813580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:00:07.822580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:00:09.782580 (Thread-1): finished collecting timing info
2021-11-09 20:00:09.783580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab59c8a3-cdb8-4478-b40b-355fb59f84c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008AEC208>]}
2021-11-09 20:00:09.783580 (Thread-1): 14:00:09 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.99s]
2021-11-09 20:00:09.784580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:00:09.885580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:00:09.886580 (MainThread): 14:00:09 | 
2021-11-09 20:00:09.887580 (MainThread): 14:00:09 | Finished running 2 view models, 1 table model in 9.12s.
2021-11-09 20:00:09.887580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:00:09.888580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:00:09.888580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:00:09.888580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:00:09.890580 (MainThread): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 60583), raddr=('142.250.190.10', 443)>
2021-11-09 20:00:09.890580 (MainThread): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 60584), raddr=('142.250.190.10', 443)>
2021-11-09 20:00:09.905580 (MainThread): 
2021-11-09 20:00:09.905580 (MainThread): Completed successfully
2021-11-09 20:00:09.906580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:00:09.907580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008635608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086B5788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087B6908>]}
2021-11-09 20:00:09.908580 (MainThread): Flushing usage events
2021-11-09 20:07:32.162580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:07:33.103580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:07:33.107580 (MainThread): Tracking: tracking
2021-11-09 20:07:33.107580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004454988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004409048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863A308>]}
2021-11-09 20:07:33.125580 (MainThread): Partial parsing not enabled
2021-11-09 20:07:33.210580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:07:33.250580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:07:33.260580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:07:33.263580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:07:33.267580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:07:33.290580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:07:33.294580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:07:33.298580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:07:33.313580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:07:33.317580 (MainThread): Parsing macros\core.sql
2021-11-09 20:07:33.323580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:07:33.412580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:07:33.426580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:07:33.428580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:07:33.431580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:07:33.435580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:07:33.437580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:07:33.439580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:07:33.442580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:07:33.457580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:07:33.470580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:07:33.491580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:07:33.493580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:07:33.510580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:07:33.541580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:07:33.577580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:07:33.628580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:07:33.631580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:07:33.658580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:07:33.671580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:07:33.677580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:07:33.689580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:07:33.692580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:07:33.694580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:07:33.696580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:07:34.012580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:07:34.031580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:07:34.037580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:07:34.108580 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle-shop
- models.jaffle-shop.example

2021-11-09 20:07:34.115580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e33764-3c5f-4f79-9e71-9c27c2eba76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086B4C08>]}
2021-11-09 20:07:34.127580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e33764-3c5f-4f79-9e71-9c27c2eba76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008717888>]}
2021-11-09 20:07:34.128580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:07:34.130580 (MainThread): 
2021-11-09 20:07:34.130580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:07:34.132580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:07:34.132580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:07:34.894580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:07:34.894580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:07:34.902580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:07:35.435580 (MainThread): 14:07:35 | Concurrency: 1 threads (target='dev')
2021-11-09 20:07:35.436580 (MainThread): 14:07:35 | 
2021-11-09 20:07:35.449580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:07:35.449580 (Thread-1): 14:07:35 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:07:35.450580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:07:35.451580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:07:35.453580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:07:35.459580 (Thread-1): finished collecting timing info
2021-11-09 20:07:35.503580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:07:35.509580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:07:35.515580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-09 20:07:36.908580 (Thread-1): finished collecting timing info
2021-11-09 20:07:36.909580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e33764-3c5f-4f79-9e71-9c27c2eba76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875BD08>]}
2021-11-09 20:07:36.910580 (Thread-1): 14:07:36 | 1 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.46s]
2021-11-09 20:07:36.912580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:07:36.912580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:07:36.913580 (Thread-1): 14:07:36 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:07:36.914580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:07:36.914580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:07:36.918580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:07:36.924580 (Thread-1): finished collecting timing info
2021-11-09 20:07:36.950580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:07:36.956580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:07:37.509580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:07:37.514580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:07:40.997580 (Thread-1): finished collecting timing info
2021-11-09 20:07:40.998580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e33764-3c5f-4f79-9e71-9c27c2eba76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000874E608>]}
2021-11-09 20:07:40.999580 (Thread-1): 14:07:40 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.08s]
2021-11-09 20:07:41.001580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:07:41.002580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:07:41.002580 (Thread-1): 14:07:41 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:07:41.004580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:07:41.004580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:07:41.009580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:07:41.013580 (Thread-1): finished collecting timing info
2021-11-09 20:07:41.019580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:07:41.023580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:07:41.029580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:07:42.697580 (Thread-1): finished collecting timing info
2021-11-09 20:07:42.698580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e33764-3c5f-4f79-9e71-9c27c2eba76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008807A88>]}
2021-11-09 20:07:42.699580 (Thread-1): 14:07:42 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.69s]
2021-11-09 20:07:42.701580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:07:42.752580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:07:42.753580 (MainThread): 14:07:42 | 
2021-11-09 20:07:42.753580 (MainThread): 14:07:42 | Finished running 2 view models, 1 table model in 8.62s.
2021-11-09 20:07:42.754580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:07:42.755580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:07:42.755580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:07:42.755580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:07:42.757580 (MainThread): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59312), raddr=('172.217.4.42', 443)>
2021-11-09 20:07:42.758580 (MainThread): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59313), raddr=('142.250.190.10', 443)>
2021-11-09 20:07:42.774580 (MainThread): 
2021-11-09 20:07:42.774580 (MainThread): Completed successfully
2021-11-09 20:07:42.776580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:07:42.777580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087A5A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000864AD48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000884B688>]}
2021-11-09 20:07:42.777580 (MainThread): Flushing usage events
2021-11-09 20:08:19.108580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:08:19.833580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:08:19.838580 (MainThread): Tracking: tracking
2021-11-09 20:08:19.839580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008628288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863A0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086286C8>]}
2021-11-09 20:08:19.857580 (MainThread): Partial parsing not enabled
2021-11-09 20:08:19.912580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:08:19.960580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:08:19.975580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:08:19.980580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:08:19.989580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:08:20.022580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:08:20.029580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:08:20.034580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:08:20.051580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:08:20.055580 (MainThread): Parsing macros\core.sql
2021-11-09 20:08:20.061580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:08:20.170580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:08:20.184580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:08:20.188580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:08:20.191580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:08:20.194580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:08:20.197580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:08:20.200580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:08:20.204580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:08:20.223580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:08:20.239580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:08:20.264580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:08:20.267580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:08:20.286580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:08:20.321580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:08:20.360580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:08:20.416580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:08:20.420580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:08:20.450580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:08:20.463580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:08:20.470580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:08:20.482580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:08:20.486580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:08:20.489580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:08:20.491580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:08:21.059580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:08:21.081580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:08:21.087580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:08:21.177580 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle-shop
- models.jaffle-shop.example

2021-11-09 20:08:21.190580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8187577-0bef-4539-8e55-bcacb6c732fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086D0188>]}
2021-11-09 20:08:21.204580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8187577-0bef-4539-8e55-bcacb6c732fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008751848>]}
2021-11-09 20:08:21.205580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:08:21.206580 (MainThread): 
2021-11-09 20:08:21.207580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:08:21.209580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:08:21.209580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:08:21.908580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:08:21.909580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:08:21.916580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:08:22.418580 (MainThread): 14:08:22 | Concurrency: 1 threads (target='dev')
2021-11-09 20:08:22.419580 (MainThread): 14:08:22 | 
2021-11-09 20:08:22.424580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:08:22.425580 (Thread-1): 14:08:22 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:08:22.426580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:08:22.426580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:08:22.428580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:08:22.435580 (Thread-1): finished collecting timing info
2021-11-09 20:08:22.486580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:08:22.492580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:08:22.500580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-09 20:08:24.099580 (Thread-1): finished collecting timing info
2021-11-09 20:08:24.100580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8187577-0bef-4539-8e55-bcacb6c732fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008765288>]}
2021-11-09 20:08:24.101580 (Thread-1): 14:08:24 | 1 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.68s]
2021-11-09 20:08:24.103580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:08:24.104580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:08:24.105580 (Thread-1): 14:08:24 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:08:24.106580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:08:24.106580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:08:24.110580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:08:24.119580 (Thread-1): finished collecting timing info
2021-11-09 20:08:24.145580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:08:24.152580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:08:24.670580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:08:24.676580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:08:26.971580 (Thread-1): finished collecting timing info
2021-11-09 20:08:26.972580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8187577-0bef-4539-8e55-bcacb6c732fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008AC2E88>]}
2021-11-09 20:08:26.972580 (Thread-1): 14:08:26 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.87s]
2021-11-09 20:08:26.974580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:08:26.975580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:08:26.975580 (Thread-1): 14:08:26 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:08:26.977580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:08:26.977580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:08:26.980580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:08:26.983580 (Thread-1): finished collecting timing info
2021-11-09 20:08:26.986580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:08:26.990580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:08:26.999580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:08:28.220580 (Thread-1): finished collecting timing info
2021-11-09 20:08:28.221580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8187577-0bef-4539-8e55-bcacb6c732fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008ADBF88>]}
2021-11-09 20:08:28.222580 (Thread-1): 14:08:28 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.24s]
2021-11-09 20:08:28.224580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:08:28.232580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:08:28.232580 (MainThread): 14:08:28 | 
2021-11-09 20:08:28.233580 (MainThread): 14:08:28 | Finished running 2 view models, 1 table model in 7.03s.
2021-11-09 20:08:28.234580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:08:28.234580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:08:28.234580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:08:28.234580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:08:28.235580 (MainThread): unclosed <socket.socket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59366), raddr=('172.217.4.42', 443)>
2021-11-09 20:08:28.236580 (MainThread): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59367), raddr=('142.250.190.10', 443)>
2021-11-09 20:08:28.251580 (MainThread): 
2021-11-09 20:08:28.251580 (MainThread): Completed successfully
2021-11-09 20:08:28.253580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:08:28.254580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000873EC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875DB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875D508>]}
2021-11-09 20:08:28.254580 (MainThread): Flushing usage events
2021-11-09 20:14:19.440580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:14:20.196580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:14:20.199580 (MainThread): Tracking: tracking
2021-11-09 20:14:20.200580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C3C448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C45648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C3C888>]}
2021-11-09 20:14:20.225580 (MainThread): Partial parsing not enabled
2021-11-09 20:14:20.277580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:14:20.315580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:14:20.325580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:14:20.328580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:14:20.333580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:14:20.358580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:14:20.362580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:14:20.364580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:14:20.379580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:14:20.384580 (MainThread): Parsing macros\core.sql
2021-11-09 20:14:20.391580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:14:20.486580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:14:20.499580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:14:20.502580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:14:20.507580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:14:20.511580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:14:20.513580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:14:20.515580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:14:20.518580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:14:20.538580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:14:20.553580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:14:20.579580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:14:20.581580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:14:20.598580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:14:20.631580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:14:20.671580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:14:20.725580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:14:20.728580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:14:20.757580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:14:20.771580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:14:20.777580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:14:20.792580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:14:20.796580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:14:20.798580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:14:20.801580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:14:21.161580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:14:21.182580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:14:21.188580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:14:21.268580 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle-shop.example
- models.jaffle-shop

2021-11-09 20:14:21.279580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a6ed10-d017-4df0-9fec-e9114e816c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086F7AC8>]}
2021-11-09 20:14:21.292580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a6ed10-d017-4df0-9fec-e9114e816c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008714848>]}
2021-11-09 20:14:21.293580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:14:21.295580 (MainThread): 
2021-11-09 20:14:21.295580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:14:21.297580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:14:21.298580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:14:22.005580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:14:22.006580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:14:22.015580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:14:22.518580 (MainThread): 14:14:22 | Concurrency: 1 threads (target='dev')
2021-11-09 20:14:22.519580 (MainThread): 14:14:22 | 
2021-11-09 20:14:22.525580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:14:22.526580 (Thread-1): 14:14:22 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:14:22.527580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:14:22.527580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:14:22.530580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:14:22.539580 (Thread-1): finished collecting timing info
2021-11-09 20:14:22.593580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:14:22.599580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:14:22.610580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-09 20:14:23.989580 (Thread-1): finished collecting timing info
2021-11-09 20:14:23.990580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6ed10-d017-4df0-9fec-e9114e816c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008772588>]}
2021-11-09 20:14:23.991580 (Thread-1): 14:14:23 | 1 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.46s]
2021-11-09 20:14:23.992580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:14:23.992580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:14:23.993580 (Thread-1): 14:14:23 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:14:23.994580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:14:23.994580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:14:23.998580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:14:24.004580 (Thread-1): finished collecting timing info
2021-11-09 20:14:24.030580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:14:24.040580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:14:24.565580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:14:24.571580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:14:27.030580 (Thread-1): finished collecting timing info
2021-11-09 20:14:27.030580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6ed10-d017-4df0-9fec-e9114e816c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000882C288>]}
2021-11-09 20:14:27.031580 (Thread-1): 14:14:27 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.04s]
2021-11-09 20:14:27.032580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:14:27.033580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:14:27.034580 (Thread-1): 14:14:27 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:14:27.034580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:14:27.035580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:14:27.038580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:14:27.041580 (Thread-1): finished collecting timing info
2021-11-09 20:14:27.044580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:14:27.050580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:14:27.056580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:14:28.625580 (Thread-1): finished collecting timing info
2021-11-09 20:14:28.625580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6ed10-d017-4df0-9fec-e9114e816c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000065E9148>]}
2021-11-09 20:14:28.627580 (Thread-1): 14:14:28 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.59s]
2021-11-09 20:14:28.628580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:14:28.654580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:14:28.655580 (MainThread): 14:14:28 | 
2021-11-09 20:14:28.655580 (MainThread): 14:14:28 | Finished running 2 view models, 1 table model in 7.36s.
2021-11-09 20:14:28.656580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:14:28.656580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:14:28.656580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:14:28.656580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:14:28.657580 (MainThread): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59724), raddr=('142.250.190.106', 443)>
2021-11-09 20:14:28.658580 (MainThread): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 59725), raddr=('142.250.190.10', 443)>
2021-11-09 20:14:28.671580 (MainThread): 
2021-11-09 20:14:28.672580 (MainThread): Completed successfully
2021-11-09 20:14:28.673580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:14:28.674580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C58B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008700DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008A86AC8>]}
2021-11-09 20:14:28.674580 (MainThread): Flushing usage events
2021-11-09 20:16:52.554580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:16:53.379580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:16:53.382580 (MainThread): Tracking: tracking
2021-11-09 20:16:53.383580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085A4388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085A4608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085A47C8>]}
2021-11-09 20:16:53.403580 (MainThread): Partial parsing not enabled
2021-11-09 20:16:53.459580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:16:53.500580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:16:53.511580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:16:53.515580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:16:53.519580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:16:53.545580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:16:53.550580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:16:53.552580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:16:53.570580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:16:53.574580 (MainThread): Parsing macros\core.sql
2021-11-09 20:16:53.581580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:16:53.719580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:16:53.758580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:16:53.763580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:16:53.770580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:16:53.777580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:16:53.781580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:16:53.785580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:16:53.791580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:16:53.842580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:16:53.867580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:16:53.920580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:16:53.925580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:16:53.970580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:16:54.058580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:16:54.172580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:16:54.303580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:16:54.308580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:16:54.391580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:16:54.404580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:16:54.413580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:16:54.430580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:16:54.436580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:16:54.439580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:16:54.443580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:16:55.091580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:16:55.124580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:16:55.135580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:16:55.267580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee01443f-da81-4d53-a719-1249db198398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000877EFC8>]}
2021-11-09 20:16:55.281580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee01443f-da81-4d53-a719-1249db198398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008707048>]}
2021-11-09 20:16:55.282580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:16:55.284580 (MainThread): 
2021-11-09 20:16:55.285580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:16:55.286580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:16:55.287580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:16:55.941580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:16:55.941580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:16:55.949580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:16:56.474580 (MainThread): 14:16:56 | Concurrency: 1 threads (target='dev')
2021-11-09 20:16:56.475580 (MainThread): 14:16:56 | 
2021-11-09 20:16:56.483580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:16:56.484580 (Thread-1): 14:16:56 | 1 of 3 START table model dbt_brooke.customers........................ [RUN]
2021-11-09 20:16:56.485580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:16:56.486580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:16:56.487580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:16:56.498580 (Thread-1): finished collecting timing info
2021-11-09 20:16:56.539580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:16:56.545580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:16:57.093580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:16:57.292580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:16:57.299580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-11-09 20:17:00.765580 (Thread-1): finished collecting timing info
2021-11-09 20:17:00.765580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee01443f-da81-4d53-a719-1249db198398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087496C8>]}
2021-11-09 20:17:00.766580 (Thread-1): 14:17:00 | 1 of 3 OK created table model dbt_brooke.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 4.28s]
2021-11-09 20:17:00.768580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:17:00.769580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:17:00.770580 (Thread-1): 14:17:00 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:17:00.771580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:17:00.771580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:17:00.776580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:17:00.783580 (Thread-1): finished collecting timing info
2021-11-09 20:17:00.786580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:17:00.794580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:17:01.304580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:17:01.312580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:17:03.996580 (Thread-1): finished collecting timing info
2021-11-09 20:17:03.997580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee01443f-da81-4d53-a719-1249db198398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087E67C8>]}
2021-11-09 20:17:03.998580 (Thread-1): 14:17:03 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.23s]
2021-11-09 20:17:04.001580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:17:04.001580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:17:04.002580 (Thread-1): 14:17:04 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:17:04.003580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:17:04.004580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:17:04.011580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:17:04.015580 (Thread-1): finished collecting timing info
2021-11-09 20:17:04.047580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:17:04.052580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:17:04.060580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:17:05.316580 (Thread-1): finished collecting timing info
2021-11-09 20:17:05.317580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee01443f-da81-4d53-a719-1249db198398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000690E6C8>]}
2021-11-09 20:17:05.318580 (Thread-1): 14:17:05 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.31s]
2021-11-09 20:17:05.320580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:17:05.390580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:17:05.391580 (MainThread): 14:17:05 | 
2021-11-09 20:17:05.392580 (MainThread): 14:17:05 | Finished running 2 table models, 1 view model in 10.11s.
2021-11-09 20:17:05.392580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:17:05.393580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:17:05.393580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:17:05.393580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:17:05.407580 (MainThread): 
2021-11-09 20:17:05.409580 (MainThread): Completed successfully
2021-11-09 20:17:05.410580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:17:05.411580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087C8748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087C8708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875D848>]}
2021-11-09 20:17:05.411580 (MainThread): Flushing usage events
2021-11-09 20:21:59.529580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:22:00.479580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:22:00.484580 (MainThread): Tracking: tracking
2021-11-09 20:22:00.484580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000862A648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863AA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000862A548>]}
2021-11-09 20:22:00.521580 (MainThread): Partial parsing not enabled
2021-11-09 20:22:00.606580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:22:00.645580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:22:00.655580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:22:00.658580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:22:00.664580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:22:00.689580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:22:00.696580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:22:00.698580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:22:00.714580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:22:00.721580 (MainThread): Parsing macros\core.sql
2021-11-09 20:22:00.728580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:22:00.829580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:22:00.844580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:22:00.846580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:22:00.849580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:22:00.857580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:22:00.860580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:22:00.862580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:22:00.865580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:22:00.881580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:22:00.894580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:22:00.916580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:22:00.919580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:22:00.938580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:22:00.973580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:22:01.013580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:22:01.074580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:22:01.077580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:22:01.105580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:22:01.120580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:22:01.127580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:22:01.141580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:22:01.145580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:22:01.149580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:22:01.152580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:22:01.539580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:22:01.563580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:22:01.570580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:22:01.667580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '595c7a71-4ffc-4ed0-a3b1-435a44cdc246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863A808>]}
2021-11-09 20:22:01.685580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '595c7a71-4ffc-4ed0-a3b1-435a44cdc246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008718888>]}
2021-11-09 20:22:01.686580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:22:01.688580 (MainThread): 
2021-11-09 20:22:01.689580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:22:01.691580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:22:01.692580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:22:03.495580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:22:03.496580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:22:03.504580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:22:04.718580 (MainThread): 14:22:04 | Concurrency: 1 threads (target='dev')
2021-11-09 20:22:04.719580 (MainThread): 14:22:04 | 
2021-11-09 20:22:04.733580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:22:04.734580 (Thread-1): 14:22:04 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:22:04.735580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:22:04.735580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:22:04.742580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:22:04.750580 (Thread-1): finished collecting timing info
2021-11-09 20:22:04.787580 (Thread-1): finished collecting timing info
2021-11-09 20:22:04.787580 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1017, in inner
    raise exc
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 686, in relation_wrong_type
    model)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2021-11-09 20:22:04.798580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '595c7a71-4ffc-4ed0-a3b1-435a44cdc246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087E1808>]}
2021-11-09 20:22:04.800580 (Thread-1): 14:22:04 | 1 of 3 ERROR creating view model dbt_brooke.customers................ [ERROR in 0.06s]
2021-11-09 20:22:04.801580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:22:04.801580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:22:04.802580 (Thread-1): 14:22:04 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:22:04.803580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:22:04.803580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:22:04.808580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:22:04.816580 (Thread-1): finished collecting timing info
2021-11-09 20:22:04.840580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:22:04.847580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:22:05.520580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:22:05.526580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:22:07.945580 (Thread-1): finished collecting timing info
2021-11-09 20:22:07.946580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '595c7a71-4ffc-4ed0-a3b1-435a44cdc246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875E1C8>]}
2021-11-09 20:22:07.947580 (Thread-1): 14:22:07 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.14s]
2021-11-09 20:22:07.949580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:22:07.950580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:22:07.950580 (Thread-1): 14:22:07 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:22:07.952580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:22:07.952580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:22:07.958580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:22:07.962580 (Thread-1): finished collecting timing info
2021-11-09 20:22:07.975580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:22:07.979580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:22:07.985580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:22:09.265580 (Thread-1): finished collecting timing info
2021-11-09 20:22:09.266580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '595c7a71-4ffc-4ed0-a3b1-435a44cdc246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000887F1C8>]}
2021-11-09 20:22:09.267580 (Thread-1): 14:22:09 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.32s]
2021-11-09 20:22:09.268580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:22:09.347580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:22:09.347580 (MainThread): 14:22:09 | 
2021-11-09 20:22:09.348580 (MainThread): 14:22:09 | Finished running 2 view models, 1 table model in 7.66s.
2021-11-09 20:22:09.349580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:22:09.350580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:22:09.350580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:22:09.350580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:22:09.363580 (MainThread): 
2021-11-09 20:22:09.364580 (MainThread): Completed with 1 error and 0 warnings:
2021-11-09 20:22:09.365580 (MainThread): 
2021-11-09 20:22:09.365580 (MainThread): Compilation Error in model customers (models\customers.sql)
2021-11-09 20:22:09.366580 (MainThread):   Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-11-09 20:22:09.367580 (MainThread):   
2021-11-09 20:22:09.369580 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2021-11-09 20:22:09.370580 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2021-11-09 20:22:09.371580 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2021-11-09 20:22:09.372580 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2021-11-09 20:22:09.373580 (MainThread):   > called by model customers (models\customers.sql)
2021-11-09 20:22:09.373580 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-11-09 20:22:09.374580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008875F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000886C788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087E6188>]}
2021-11-09 20:22:09.375580 (MainThread): Flushing usage events
2021-11-09 20:27:04.575580 (MainThread): Running with dbt=0.21.0
2021-11-09 20:27:05.415580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-09 20:27:05.417580 (MainThread): Tracking: tracking
2021-11-09 20:27:05.418580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C373C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000044103C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C37808>]}
2021-11-09 20:27:05.436580 (MainThread): Partial parsing not enabled
2021-11-09 20:27:05.491580 (MainThread): Parsing macros\adapters.sql
2021-11-09 20:27:05.549580 (MainThread): Parsing macros\catalog.sql
2021-11-09 20:27:05.563580 (MainThread): Parsing macros\etc.sql
2021-11-09 20:27:05.570580 (MainThread): Parsing macros\materializations\copy.sql
2021-11-09 20:27:05.578580 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-09 20:27:05.603580 (MainThread): Parsing macros\materializations\seed.sql
2021-11-09 20:27:05.608580 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-09 20:27:05.611580 (MainThread): Parsing macros\materializations\table.sql
2021-11-09 20:27:05.626580 (MainThread): Parsing macros\materializations\view.sql
2021-11-09 20:27:05.631580 (MainThread): Parsing macros\core.sql
2021-11-09 20:27:05.639580 (MainThread): Parsing macros\adapters\common.sql
2021-11-09 20:27:05.739580 (MainThread): Parsing macros\etc\datetime.sql
2021-11-09 20:27:05.753580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-09 20:27:05.756580 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-09 20:27:05.760580 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-09 20:27:05.766580 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-09 20:27:05.772580 (MainThread): Parsing macros\etc\query.sql
2021-11-09 20:27:05.776580 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-09 20:27:05.781580 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-09 20:27:05.806580 (MainThread): Parsing macros\materializations\test.sql
2021-11-09 20:27:05.819580 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-09 20:27:05.843580 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-09 20:27:05.845580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-09 20:27:05.866580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-09 20:27:05.902580 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-09 20:27:05.940580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-09 20:27:05.994580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-09 20:27:05.997580 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-09 20:27:06.041580 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-09 20:27:06.062580 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-09 20:27:06.076580 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-09 20:27:06.087580 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-09 20:27:06.091580 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-09 20:27:06.094580 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-09 20:27:06.097580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-09 20:27:06.512580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:27:06.577580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:27:06.587580 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:27:06.747580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9601cc6-a4ae-420e-8e9c-643a05c34ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004C46C48>]}
2021-11-09 20:27:06.765580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9601cc6-a4ae-420e-8e9c-643a05c34ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008733848>]}
2021-11-09 20:27:06.765580 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-09 20:27:06.768580 (MainThread): 
2021-11-09 20:27:06.770580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:27:06.772580 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-09 20:27:06.773580 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 20:27:07.534580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-09 20:27:07.535580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 20:27:07.542580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:27:08.097580 (MainThread): 14:27:08 | Concurrency: 1 threads (target='dev')
2021-11-09 20:27:08.098580 (MainThread): 14:27:08 | 
2021-11-09 20:27:08.103580 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-09 20:27:08.103580 (Thread-1): 14:27:08 | 1 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-09 20:27:08.104580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-09 20:27:08.104580 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-09 20:27:08.107580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-09 20:27:08.112580 (Thread-1): finished collecting timing info
2021-11-09 20:27:08.145580 (Thread-1): Opening a new connection, currently in state init
2021-11-09 20:27:08.153580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:27:08.810580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-09 20:27:08.817580 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-09 20:27:09.776580 (Thread-1): finished collecting timing info
2021-11-09 20:27:09.778580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9601cc6-a4ae-420e-8e9c-643a05c34ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008733A88>]}
2021-11-09 20:27:09.779580 (Thread-1): 14:27:09 | 1 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.67s]
2021-11-09 20:27:09.781580 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-09 20:27:09.781580 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:27:09.782580 (Thread-1): 14:27:09 | 2 of 3 START table model dbt_brooke.my_first_dbt_model............... [RUN]
2021-11-09 20:27:09.783580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-11-09 20:27:09.783580 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-11-09 20:27:09.786580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:27:09.792580 (Thread-1): finished collecting timing info
2021-11-09 20:27:09.830580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:27:09.836580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-09 20:27:10.376580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-11-09 20:27:10.382580 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-11-09 20:27:12.748580 (Thread-1): finished collecting timing info
2021-11-09 20:27:12.748580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9601cc6-a4ae-420e-8e9c-643a05c34ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000088A66C8>]}
2021-11-09 20:27:12.749580 (Thread-1): 14:27:12 | 2 of 3 OK created table model dbt_brooke.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.97s]
2021-11-09 20:27:12.750580 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-11-09 20:27:12.753580 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:27:12.753580 (Thread-1): 14:27:12 | 3 of 3 START view model dbt_brooke.my_second_dbt_model............... [RUN]
2021-11-09 20:27:12.756580 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-11-09 20:27:12.756580 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-11-09 20:27:12.762580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:27:12.770580 (Thread-1): finished collecting timing info
2021-11-09 20:27:12.780580 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-11-09 20:27:12.789580 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 20:27:12.801580 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`my_first_dbt_model`
where id = 1;


2021-11-09 20:27:14.065580 (Thread-1): finished collecting timing info
2021-11-09 20:27:14.066580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9601cc6-a4ae-420e-8e9c-643a05c34ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008B18E88>]}
2021-11-09 20:27:14.067580 (Thread-1): 14:27:14 | 3 of 3 OK created view model dbt_brooke.my_second_dbt_model.......... [OK in 1.31s]
2021-11-09 20:27:14.068580 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-11-09 20:27:14.116580 (MainThread): Acquiring new bigquery connection "master".
2021-11-09 20:27:14.117580 (MainThread): 14:27:14 | 
2021-11-09 20:27:14.117580 (MainThread): 14:27:14 | Finished running 2 view models, 1 table model in 7.35s.
2021-11-09 20:27:14.118580 (MainThread): Connection 'master' was properly closed.
2021-11-09 20:27:14.118580 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-09 20:27:14.118580 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-09 20:27:14.119580 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-11-09 20:27:14.120580 (MainThread): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 60545), raddr=('142.250.190.74', 443)>
2021-11-09 20:27:14.121580 (MainThread): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.128', 60546), raddr=('142.250.190.10', 443)>
2021-11-09 20:27:14.133580 (MainThread): 
2021-11-09 20:27:14.134580 (MainThread): Completed successfully
2021-11-09 20:27:14.135580 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-09 20:27:14.135580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008B4B448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008B4B388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008B4BB48>]}
2021-11-09 20:27:14.136580 (MainThread): Flushing usage events
2021-11-11 16:35:28.979661 (MainThread): Running with dbt=0.21.0
2021-11-11 16:35:30.271790 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 16:35:30.275791 (MainThread): Tracking: tracking
2021-11-11 16:35:30.276791 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B67D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B67C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B67C48>]}
2021-11-11 16:35:30.295793 (MainThread): Partial parsing not enabled
2021-11-11 16:35:30.377801 (MainThread): Parsing macros\adapters.sql
2021-11-11 16:35:30.418805 (MainThread): Parsing macros\catalog.sql
2021-11-11 16:35:30.428806 (MainThread): Parsing macros\etc.sql
2021-11-11 16:35:30.431806 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 16:35:30.435807 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 16:35:30.459809 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 16:35:30.467810 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 16:35:30.470810 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 16:35:30.491812 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 16:35:30.501813 (MainThread): Parsing macros\core.sql
2021-11-11 16:35:30.509814 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 16:35:30.611824 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 16:35:30.626826 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 16:35:30.631826 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 16:35:30.634827 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 16:35:30.637827 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 16:35:30.640827 (MainThread): Parsing macros\etc\query.sql
2021-11-11 16:35:30.642827 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 16:35:30.645828 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 16:35:30.662829 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 16:35:30.674831 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 16:35:30.698833 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 16:35:30.701833 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 16:35:30.719835 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 16:35:30.753839 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 16:35:30.795843 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 16:35:30.851848 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 16:35:30.855849 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 16:35:30.886852 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 16:35:30.899853 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 16:35:30.906854 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 16:35:30.921855 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 16:35:30.925856 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 16:35:30.926856 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 16:35:30.929856 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 16:35:31.299893 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 16:35:31.370900 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be336c78-0c02-4b8b-ade9-af40f0ce56b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008673A88>]}
2021-11-11 16:35:31.396903 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be336c78-0c02-4b8b-ade9-af40f0ce56b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085ECCC8>]}
2021-11-11 16:35:31.397903 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 16:35:31.398903 (MainThread): 
2021-11-11 16:35:31.399903 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 16:35:31.400903 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 16:35:31.401903 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 16:35:32.179981 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 16:35:32.179981 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 16:35:32.191982 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 16:35:32.759039 (MainThread): 10:35:32 | Concurrency: 1 threads (target='dev')
2021-11-11 16:35:32.760039 (MainThread): 10:35:32 | 
2021-11-11 16:35:32.768040 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 16:35:32.768040 (Thread-1): 10:35:32 | 1 of 1 START view model dbt_brooke.customers......................... [RUN]
2021-11-11 16:35:32.769040 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 16:35:32.769040 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-11 16:35:32.772040 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-11 16:35:32.783041 (Thread-1): finished collecting timing info
2021-11-11 16:35:32.838047 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-11 16:35:32.849048 (Thread-1): Opening a new connection, currently in state init
2021-11-11 16:35:32.857049 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-11 16:35:34.197183 (Thread-1): finished collecting timing info
2021-11-11 16:35:34.198183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be336c78-0c02-4b8b-ade9-af40f0ce56b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086739C8>]}
2021-11-11 16:35:34.199183 (Thread-1): 10:35:34 | 1 of 1 OK created view model dbt_brooke.customers.................... [OK in 1.43s]
2021-11-11 16:35:34.200183 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 16:35:34.268190 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 16:35:34.269190 (MainThread): 10:35:34 | 
2021-11-11 16:35:34.269190 (MainThread): 10:35:34 | Finished running 1 view model in 2.87s.
2021-11-11 16:35:34.270190 (MainThread): Connection 'master' was properly closed.
2021-11-11 16:35:34.270190 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 16:35:34.270190 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 16:35:34.271190 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-11-11 16:35:34.290192 (MainThread): 
2021-11-11 16:35:34.291192 (MainThread): Completed successfully
2021-11-11 16:35:34.291192 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-11 16:35:34.292192 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008676A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086660C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000877F048>]}
2021-11-11 16:35:34.292192 (MainThread): Flushing usage events
2021-11-11 17:53:49.583369 (MainThread): Running with dbt=0.21.0
2021-11-11 17:53:50.513555 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 17:53:50.516556 (MainThread): Tracking: tracking
2021-11-11 17:53:50.516556 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000856DE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004329088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000856DD88>]}
2021-11-11 17:53:50.533559 (MainThread): Partial parsing not enabled
2021-11-11 17:53:50.605573 (MainThread): Parsing macros\adapters.sql
2021-11-11 17:53:50.639580 (MainThread): Parsing macros\catalog.sql
2021-11-11 17:53:50.648582 (MainThread): Parsing macros\etc.sql
2021-11-11 17:53:50.651583 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 17:53:50.655583 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 17:53:50.676588 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 17:53:50.680588 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 17:53:50.682589 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 17:53:50.696592 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 17:53:50.700592 (MainThread): Parsing macros\core.sql
2021-11-11 17:53:50.705593 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 17:53:50.784609 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 17:53:50.797612 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 17:53:50.799612 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 17:53:50.802613 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 17:53:50.805613 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 17:53:50.807614 (MainThread): Parsing macros\etc\query.sql
2021-11-11 17:53:50.809614 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 17:53:50.812615 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 17:53:50.826618 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 17:53:50.836620 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 17:53:50.856624 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 17:53:50.859624 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 17:53:50.874627 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 17:53:50.903633 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 17:53:50.937640 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 17:53:50.984649 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 17:53:50.986650 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 17:53:51.011655 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 17:53:51.022657 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 17:53:51.029658 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 17:53:51.041661 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 17:53:51.044661 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 17:53:51.047662 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 17:53:51.050662 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 17:53:51.355723 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 17:53:51.375727 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 17:53:51.379728 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 17:53:51.421737 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ebee025-5e70-4b57-8358-ef47ea46b537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086A3748>]}
2021-11-11 17:53:51.434739 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ebee025-5e70-4b57-8358-ef47ea46b537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008619288>]}
2021-11-11 17:53:51.435739 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 17:53:51.436740 (MainThread): 
2021-11-11 17:53:51.438740 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 17:53:51.440740 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 17:53:51.440740 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 17:53:52.352923 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 17:53:52.354923 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 17:53:52.388930 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 17:53:53.038060 (MainThread): 11:53:53 | Concurrency: 1 threads (target='dev')
2021-11-11 17:53:53.043061 (MainThread): 11:53:53 | 
2021-11-11 17:53:53.064065 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 17:53:53.065065 (Thread-1): 11:53:53 | 1 of 3 START table model dbt_brooke.stg_customers.................... [RUN]
2021-11-11 17:53:53.068066 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 17:53:53.069066 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 17:53:53.076067 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 17:53:53.092071 (Thread-1): finished collecting timing info
2021-11-11 17:53:53.212095 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 17:53:53.219096 (Thread-1): Opening a new connection, currently in state init
2021-11-11 17:53:53.227098 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  
  
  OPTIONS()
  as (
    SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-11-11 17:53:57.753003 (Thread-1): finished collecting timing info
2021-11-11 17:53:57.755003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebee025-5e70-4b57-8358-ef47ea46b537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007B99848>]}
2021-11-11 17:53:57.756003 (Thread-1): 11:53:57 | 1 of 3 OK created table model dbt_brooke.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 4.69s]
2021-11-11 17:53:57.759004 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 17:53:57.760004 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 17:53:57.761004 (Thread-1): 11:53:57 | 2 of 3 START table model dbt_brooke.stg_orders....................... [RUN]
2021-11-11 17:53:57.763005 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 17:53:57.764005 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 17:53:57.766005 (Thread-1): unclosed <socket.socket fd=824, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53187), raddr=('142.250.191.138', 443)>
2021-11-11 17:53:57.767005 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53188), raddr=('142.250.190.10', 443)>
2021-11-11 17:53:57.771006 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 17:53:57.786009 (Thread-1): finished collecting timing info
2021-11-11 17:53:57.793011 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 17:53:57.799012 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 17:53:57.814015 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
  
  
  OPTIONS()
  as (
    SELECT
id as order_id
, user_id as customer_id
, order_date
, STATUS

FROM `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-11-11 17:54:01.529758 (Thread-1): finished collecting timing info
2021-11-11 17:54:01.532758 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebee025-5e70-4b57-8358-ef47ea46b537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085C6E48>]}
2021-11-11 17:54:01.535759 (Thread-1): 11:54:01 | 2 of 3 OK created table model dbt_brooke.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 3.77s]
2021-11-11 17:54:01.539760 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 17:54:01.541760 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 17:54:01.543761 (Thread-1): 11:54:01 | 3 of 3 START view model dbt_brooke.customers......................... [RUN]
2021-11-11 17:54:01.546761 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 17:54:01.547761 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-11 17:54:01.565765 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-11 17:54:01.573767 (Thread-1): finished collecting timing info
2021-11-11 17:54:01.614775 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-11 17:54:01.618776 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 17:54:01.626777 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as 

with customers as (

    SELECT *
    FROM `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`

),

orders as (

    SELECT *
    FROM `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-11 17:54:03.117075 (Thread-1): finished collecting timing info
2021-11-11 17:54:03.120076 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ebee025-5e70-4b57-8358-ef47ea46b537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008939C88>]}
2021-11-11 17:54:03.122076 (Thread-1): 11:54:03 | 3 of 3 OK created view model dbt_brooke.customers.................... [OK in 1.57s]
2021-11-11 17:54:03.128077 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 17:54:03.187089 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 17:54:03.188089 (MainThread): 11:54:03 | 
2021-11-11 17:54:03.191090 (MainThread): 11:54:03 | Finished running 2 table models, 1 view model in 11.75s.
2021-11-11 17:54:03.192090 (MainThread): Connection 'master' was properly closed.
2021-11-11 17:54:03.193090 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 17:54:03.194091 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 17:54:03.195091 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-11-11 17:54:03.227097 (MainThread): 
2021-11-11 17:54:03.229098 (MainThread): Completed successfully
2021-11-11 17:54:03.231098 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-11 17:54:03.234099 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000853A448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085F07C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085C6E48>]}
2021-11-11 17:54:03.235099 (MainThread): Flushing usage events
2021-11-11 17:54:59.199289 (MainThread): Running with dbt=0.21.0
2021-11-11 17:54:59.817413 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 17:54:59.820414 (MainThread): Tracking: tracking
2021-11-11 17:54:59.821414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004374988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004329648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000084D89C8>]}
2021-11-11 17:54:59.840418 (MainThread): Partial parsing not enabled
2021-11-11 17:54:59.891428 (MainThread): Parsing macros\adapters.sql
2021-11-11 17:54:59.928435 (MainThread): Parsing macros\catalog.sql
2021-11-11 17:54:59.937437 (MainThread): Parsing macros\etc.sql
2021-11-11 17:54:59.940438 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 17:54:59.944438 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 17:54:59.966443 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 17:54:59.970444 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 17:54:59.972444 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 17:54:59.986447 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 17:54:59.991448 (MainThread): Parsing macros\core.sql
2021-11-11 17:54:59.996449 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 17:55:00.085467 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 17:55:00.098469 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 17:55:00.101470 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 17:55:00.103470 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 17:55:00.106471 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 17:55:00.109471 (MainThread): Parsing macros\etc\query.sql
2021-11-11 17:55:00.110472 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 17:55:00.113472 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 17:55:00.128475 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 17:55:00.138477 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 17:55:00.158481 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 17:55:00.161482 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 17:55:00.177485 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 17:55:00.207491 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 17:55:00.242498 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 17:55:00.291508 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 17:55:00.293508 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 17:55:00.320514 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 17:55:00.333516 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 17:55:00.341518 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 17:55:00.356521 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 17:55:00.359521 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 17:55:00.361522 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 17:55:00.364522 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 17:55:00.673584 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 17:55:00.692588 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 17:55:00.697589 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 17:55:00.740598 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5b4e27d-ec37-49af-88bd-5df1b9ada413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008693208>]}
2021-11-11 17:55:00.751600 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5b4e27d-ec37-49af-88bd-5df1b9ada413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008624E08>]}
2021-11-11 17:55:00.752600 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 17:55:00.754600 (MainThread): 
2021-11-11 17:55:00.755601 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 17:55:00.757601 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 17:55:00.757601 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 17:55:01.485747 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 17:55:01.487747 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 17:55:01.519753 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 17:55:02.221894 (MainThread): 11:55:02 | Concurrency: 1 threads (target='dev')
2021-11-11 17:55:02.223894 (MainThread): 11:55:02 | 
2021-11-11 17:55:02.239897 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 17:55:02.241898 (Thread-1): 11:55:02 | 1 of 3 START table model dbt_brooke.stg_customers.................... [RUN]
2021-11-11 17:55:02.246899 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 17:55:02.248899 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 17:55:02.256901 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 17:55:02.275905 (Thread-1): finished collecting timing info
2021-11-11 17:55:02.334916 (Thread-1): Opening a new connection, currently in state init
2021-11-11 17:55:02.342918 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 17:55:03.125074 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 17:55:03.134076 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  
  
  OPTIONS()
  as (
    SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers5
  );
    
2021-11-11 17:55:03.551160 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  
  
  OPTIONS()
  as (
    SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers5
  );
    
2021-11-11 17:55:03.552160 (Thread-1): 404 Not found: Table dbt-tutorial:jaffle_shop.customers5 was not found in location US

(job ID: c5aa7c98-b342-42b1-aa90-00107a3d5c42)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
   2:
   3:
   4:  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT
  10:id as customer_id
  11:, first_name
  12:, last_name
  13:
  14:FROM `dbt-tutorial`.jaffle_shop.customers5
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-11-11 17:55:03.554160 (Thread-1): finished collecting timing info
2021-11-11 17:55:03.557161 (Thread-1): Runtime Error in model stg_customers (models\stg_customers.sql)
  404 Not found: Table dbt-tutorial:jaffle_shop.customers5 was not found in location US
  
  (job ID: c5aa7c98-b342-42b1-aa90-00107a3d5c42)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 163, in exception_handler
    yield
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\api_core\retry.py", line 189, in retry_target
    return target()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\cloud\bigquery\job\query.py", line 1450, in result
    do_get_result()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\api_core\retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\api_core\retry.py", line 189, in retry_target
    return target()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\cloud\bigquery\job\query.py", line 1440, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\cloud\bigquery\job\base.py", line 727, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\google\api_core\future\polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table dbt-tutorial:jaffle_shop.customers5 was not found in location US

(job ID: c5aa7c98-b342-42b1-aa90-00107a3d5c42)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
   2:
   3:
   4:  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    SELECT
  10:id as customer_id
  11:, first_name
  12:, last_name
  13:
  14:FROM `dbt-tutorial`.jaffle_shop.customers5
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\base\impl.py", line 229, in execute
    fetch=fetch
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\programdata\anaconda3\envs\dbt\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\adapters\bigquery\connections.py", line 195, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_customers (models\stg_customers.sql)
  404 Not found: Table dbt-tutorial:jaffle_shop.customers5 was not found in location US
  
  (job ID: c5aa7c98-b342-42b1-aa90-00107a3d5c42)
2021-11-11 17:55:03.628175 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5b4e27d-ec37-49af-88bd-5df1b9ada413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008617308>]}
2021-11-11 17:55:03.629175 (Thread-1): 11:55:03 | 1 of 3 ERROR creating table model dbt_brooke.stg_customers........... [ERROR in 1.38s]
2021-11-11 17:55:03.633176 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 17:55:03.634176 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 17:55:03.635176 (Thread-1): 11:55:03 | 2 of 3 START table model dbt_brooke.stg_orders....................... [RUN]
2021-11-11 17:55:03.637177 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 17:55:03.637177 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 17:55:03.640177 (Thread-1): unclosed <socket.socket fd=792, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53220), raddr=('142.250.191.138', 443)>
2021-11-11 17:55:03.641178 (Thread-1): unclosed <socket.socket fd=804, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53221), raddr=('142.250.190.10', 443)>
2021-11-11 17:55:03.646179 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 17:55:03.652180 (Thread-1): finished collecting timing info
2021-11-11 17:55:03.657181 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 17:55:03.672184 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 17:55:04.372324 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 17:55:04.382326 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
  
  
  OPTIONS()
  as (
    SELECT
id as order_id
, user_id as customer_id
, order_date
, STATUS

FROM `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-11-11 17:55:07.598969 (Thread-1): finished collecting timing info
2021-11-11 17:55:07.600969 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5b4e27d-ec37-49af-88bd-5df1b9ada413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008AD4688>]}
2021-11-11 17:55:07.602970 (Thread-1): 11:55:07 | 2 of 3 OK created table model dbt_brooke.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 3.96s]
2021-11-11 17:55:07.608971 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 17:55:07.611972 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 17:55:07.612972 (Thread-1): 11:55:07 | 3 of 3 SKIP relation dbt_brooke.customers............................ [SKIP]
2021-11-11 17:55:07.617973 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 17:55:07.660981 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 17:55:07.662982 (MainThread): 11:55:07 | 
2021-11-11 17:55:07.663982 (MainThread): 11:55:07 | Finished running 2 table models, 1 view model in 6.91s.
2021-11-11 17:55:07.665982 (MainThread): Connection 'master' was properly closed.
2021-11-11 17:55:07.666983 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 17:55:07.667983 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 17:55:07.668983 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-11-11 17:55:07.710991 (MainThread): 
2021-11-11 17:55:07.712992 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 17:55:07.716993 (MainThread): 
2021-11-11 17:55:07.718993 (MainThread): Runtime Error in model stg_customers (models\stg_customers.sql)
2021-11-11 17:55:07.721994 (MainThread):   404 Not found: Table dbt-tutorial:jaffle_shop.customers5 was not found in location US
2021-11-11 17:55:07.724994 (MainThread):   
2021-11-11 17:55:07.727995 (MainThread):   (job ID: c5aa7c98-b342-42b1-aa90-00107a3d5c42)
2021-11-11 17:55:07.729995 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-11 17:55:07.731996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008CA9248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008CA9088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008CA9348>]}
2021-11-11 17:55:07.733996 (MainThread): Flushing usage events
2021-11-11 18:01:54.667790 (MainThread): Running with dbt=0.21.0
2021-11-11 18:01:55.897913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 18:01:55.900914 (MainThread): Tracking: tracking
2021-11-11 18:01:55.901914 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004374988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004329688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000856CB08>]}
2021-11-11 18:01:55.921916 (MainThread): Partial parsing not enabled
2021-11-11 18:01:56.053929 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:01:56.123936 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:01:56.137937 (MainThread): Parsing macros\etc.sql
2021-11-11 18:01:56.142938 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:01:56.148938 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:01:56.183942 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:01:56.189943 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:01:56.193943 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:01:56.216945 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:01:56.223946 (MainThread): Parsing macros\core.sql
2021-11-11 18:01:56.231947 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:01:56.387962 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:01:56.406964 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:01:56.409965 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:01:56.413965 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:01:56.419966 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:01:56.422966 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:01:56.424966 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:01:56.428966 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:01:56.448968 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:01:56.462970 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:01:56.491973 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:01:56.495973 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:01:56.516975 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:01:56.559980 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:01:56.655989 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:01:56.721996 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:01:56.725996 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:01:56.763000 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:01:56.779001 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:01:56.787002 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:01:56.802004 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:01:56.807004 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:01:56.810005 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:01:56.814005 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:01:57.283052 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:01:57.309054 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:01:57.314055 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:01:57.377061 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '212a1a53-f41a-4054-973c-ade864849b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086A38C8>]}
2021-11-11 18:01:57.391063 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '212a1a53-f41a-4054-973c-ade864849b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000861AA88>]}
2021-11-11 18:01:57.392063 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:01:57.394063 (MainThread): 
2021-11-11 18:01:57.395063 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:01:57.397063 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 18:01:57.398063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:01:58.320156 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:01:58.322156 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:01:58.352159 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:01:59.038227 (MainThread): 12:01:59 | Concurrency: 1 threads (target='dev')
2021-11-11 18:01:59.039227 (MainThread): 12:01:59 | 
2021-11-11 18:01:59.046228 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 18:01:59.046228 (Thread-1): 12:01:59 | 1 of 1 START view model dbt_brooke.customers......................... [RUN]
2021-11-11 18:01:59.047228 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:01:59.048228 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-11 18:01:59.054229 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-11 18:01:59.062230 (Thread-1): finished collecting timing info
2021-11-11 18:01:59.136237 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-11-11 18:01:59.143238 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:01:59.153239 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`customers`
  OPTIONS()
  as 

with customers as (

    SELECT *
    FROM `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`

),

orders as (

    SELECT *
    FROM `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-11-11 18:02:00.638387 (Thread-1): finished collecting timing info
2021-11-11 18:02:00.640388 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212a1a53-f41a-4054-973c-ade864849b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086AF248>]}
2021-11-11 18:02:00.641388 (Thread-1): 12:02:00 | 1 of 1 OK created view model dbt_brooke.customers.................... [OK in 1.59s]
2021-11-11 18:02:00.645388 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 18:02:00.651389 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:02:00.652389 (MainThread): 12:02:00 | 
2021-11-11 18:02:00.656389 (MainThread): 12:02:00 | Finished running 1 view model in 3.26s.
2021-11-11 18:02:00.659389 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:02:00.660390 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 18:02:00.660390 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:02:00.661390 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-11-11 18:02:00.663390 (MainThread): unclosed <socket.socket fd=664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53388), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:00.664390 (MainThread): unclosed <socket.socket fd=688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53389), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:00.665390 (MainThread): unclosed <socket.socket fd=716, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53390), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:00.666390 (MainThread): unclosed <socket.socket fd=728, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53391), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:00.666390 (MainThread): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53392), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:00.667390 (MainThread): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53393), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:00.681392 (MainThread): 
2021-11-11 18:02:00.682392 (MainThread): Completed successfully
2021-11-11 18:02:00.683392 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-11 18:02:00.685392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086A3B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086A3088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086B8E48>]}
2021-11-11 18:02:00.685392 (MainThread): Flushing usage events
2021-11-11 18:02:35.352858 (MainThread): Running with dbt=0.21.0
2021-11-11 18:02:36.187942 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 18:02:36.191942 (MainThread): Tracking: tracking
2021-11-11 18:02:36.192942 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855CD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855CD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855CC08>]}
2021-11-11 18:02:36.215945 (MainThread): Partial parsing not enabled
2021-11-11 18:02:36.259949 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:02:36.298953 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:02:36.308954 (MainThread): Parsing macros\etc.sql
2021-11-11 18:02:36.311954 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:02:36.316955 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:02:36.343958 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:02:36.352958 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:02:36.356959 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:02:36.379961 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:02:36.385962 (MainThread): Parsing macros\core.sql
2021-11-11 18:02:36.391962 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:02:36.505974 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:02:36.519975 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:02:36.521975 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:02:36.524976 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:02:36.528976 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:02:36.531976 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:02:36.533977 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:02:36.536977 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:02:36.551978 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:02:36.562979 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:02:36.583982 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:02:36.586982 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:02:36.602983 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:02:36.634987 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:02:36.685992 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:02:36.755999 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:02:36.758999 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:02:36.788002 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:02:36.801003 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:02:36.807004 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:02:36.819005 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:02:36.823005 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:02:36.826006 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:02:36.828006 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:02:37.401063 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:02:37.426066 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:02:37.431066 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:02:37.488072 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d570aff-e16e-4de2-af16-6b7785bf6a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008693848>]}
2021-11-11 18:02:37.500073 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d570aff-e16e-4de2-af16-6b7785bf6a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008617648>]}
2021-11-11 18:02:37.501073 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:02:37.503073 (MainThread): 
2021-11-11 18:02:37.504074 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:02:37.506074 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 18:02:37.507074 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:02:38.609184 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:02:38.611184 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:02:38.639187 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:02:39.389262 (MainThread): 12:02:39 | Concurrency: 1 threads (target='dev')
2021-11-11 18:02:39.390262 (MainThread): 12:02:39 | 
2021-11-11 18:02:39.420265 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 18:02:39.422265 (Thread-1): 12:02:39 | 1 of 1 START table model dbt_brooke.stg_customers.................... [RUN]
2021-11-11 18:02:39.424266 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:02:39.429266 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 18:02:39.436267 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:02:39.450268 (Thread-1): finished collecting timing info
2021-11-11 18:02:39.507274 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:02:39.514275 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:02:40.303353 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:02:40.310354 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  
  
  OPTIONS()
  as (
    SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-11-11 18:02:43.908714 (Thread-1): finished collecting timing info
2021-11-11 18:02:43.911714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d570aff-e16e-4de2-af16-6b7785bf6a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008600488>]}
2021-11-11 18:02:43.914715 (Thread-1): 12:02:43 | 1 of 1 OK created table model dbt_brooke.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 4.49s]
2021-11-11 18:02:43.920715 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 18:02:43.929716 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:02:43.931716 (MainThread): 12:02:43 | 
2021-11-11 18:02:43.932716 (MainThread): 12:02:43 | Finished running 1 table model in 6.43s.
2021-11-11 18:02:43.934717 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:02:43.936717 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 18:02:43.937717 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:02:43.937717 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-11-11 18:02:43.947718 (MainThread): unclosed <socket.socket fd=664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53415), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:43.950718 (MainThread): unclosed <socket.socket fd=688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53416), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:43.953718 (MainThread): unclosed <socket.socket fd=716, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53417), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:43.956719 (MainThread): unclosed <socket.socket fd=728, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53418), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:43.959719 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53419), raddr=('142.250.191.234', 443)>
2021-11-11 18:02:43.962719 (MainThread): unclosed <socket.socket fd=796, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53420), raddr=('142.250.190.10', 443)>
2021-11-11 18:02:44.008724 (MainThread): 
2021-11-11 18:02:44.012724 (MainThread): Completed successfully
2021-11-11 18:02:44.018725 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-11 18:02:44.020725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008678DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008709F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087093C8>]}
2021-11-11 18:02:44.024726 (MainThread): Flushing usage events
2021-11-11 18:04:07.916114 (MainThread): Running with dbt=0.21.0
2021-11-11 18:04:08.935216 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 18:04:08.937216 (MainThread): Tracking: tracking
2021-11-11 18:04:08.938216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855CE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004329088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855CD48>]}
2021-11-11 18:04:08.973220 (MainThread): Partial parsing not enabled
2021-11-11 18:04:09.037226 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:04:09.106233 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:04:09.118234 (MainThread): Parsing macros\etc.sql
2021-11-11 18:04:09.121234 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:04:09.128235 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:04:09.162238 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:04:09.166239 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:04:09.169239 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:04:09.189241 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:04:09.194242 (MainThread): Parsing macros\core.sql
2021-11-11 18:04:09.199242 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:04:09.303253 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:04:09.331255 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:04:09.335256 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:04:09.340256 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:04:09.349257 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:04:09.355258 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:04:09.360258 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:04:09.366259 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:04:09.399262 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:04:09.416264 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:04:09.470269 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:04:09.480270 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:04:09.503273 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:04:09.555278 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:04:09.614284 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:04:09.720294 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:04:09.725295 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:04:09.810303 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:04:09.834306 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:04:09.847307 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:04:09.864309 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:04:09.870309 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:04:09.873310 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:04:09.880310 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:04:10.417364 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:04:10.449367 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:04:10.454368 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:04:10.532375 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a749f70c-ad85-4a4e-9443-f8a4641a46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000866E2C8>]}
2021-11-11 18:04:10.562378 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a749f70c-ad85-4a4e-9443-f8a4641a46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000860A288>]}
2021-11-11 18:04:10.564379 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:04:10.568379 (MainThread): 
2021-11-11 18:04:10.570379 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:04:10.574380 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 18:04:10.576380 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:04:11.250447 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:04:11.251447 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:04:11.272449 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:04:11.947517 (MainThread): 12:04:11 | Concurrency: 1 threads (target='dev')
2021-11-11 18:04:11.949517 (MainThread): 12:04:11 | 
2021-11-11 18:04:11.963519 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 18:04:11.965519 (Thread-1): 12:04:11 | 1 of 2 START table model dbt_brooke.stg_customers.................... [RUN]
2021-11-11 18:04:11.968519 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:04:11.969519 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 18:04:11.975520 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:04:11.990521 (Thread-1): finished collecting timing info
2021-11-11 18:04:12.066529 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:04:12.077530 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:04:12.797602 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:04:12.814604 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  
  
  OPTIONS()
  as (
    SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-11-11 18:04:16.939016 (Thread-1): finished collecting timing info
2021-11-11 18:04:16.943016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a749f70c-ad85-4a4e-9443-f8a4641a46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007B9B748>]}
2021-11-11 18:04:16.945017 (Thread-1): 12:04:16 | 1 of 2 OK created table model dbt_brooke.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 4.97s]
2021-11-11 18:04:16.949017 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 18:04:16.952017 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 18:04:16.955018 (Thread-1): 12:04:16 | 2 of 2 START table model dbt_brooke.stg_orders....................... [RUN]
2021-11-11 18:04:16.957018 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:04:16.958018 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 18:04:16.962018 (Thread-1): unclosed <socket.socket fd=792, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53443), raddr=('142.250.191.234', 443)>
2021-11-11 18:04:16.963018 (Thread-1): unclosed <socket.socket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 53445), raddr=('142.250.190.10', 443)>
2021-11-11 18:04:16.974020 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:04:16.985021 (Thread-1): finished collecting timing info
2021-11-11 18:04:16.993021 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:04:17.015024 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:04:18.081130 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:04:18.090131 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
  
  
  OPTIONS()
  as (
    SELECT
id as order_id
, user_id as customer_id
, order_date
, STATUS

FROM `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-11-11 18:04:21.526475 (Thread-1): finished collecting timing info
2021-11-11 18:04:21.530475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a749f70c-ad85-4a4e-9443-f8a4641a46dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000875EA48>]}
2021-11-11 18:04:21.535476 (Thread-1): 12:04:21 | 2 of 2 OK created table model dbt_brooke.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 4.57s]
2021-11-11 18:04:21.542476 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 18:04:21.602482 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:04:21.604483 (MainThread): 12:04:21 | 
2021-11-11 18:04:21.605483 (MainThread): 12:04:21 | Finished running 2 table models in 11.04s.
2021-11-11 18:04:21.607483 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:04:21.608483 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 18:04:21.608483 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:04:21.609483 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-11-11 18:04:21.640486 (MainThread): 
2021-11-11 18:04:21.641486 (MainThread): Completed successfully
2021-11-11 18:04:21.644487 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-11 18:04:21.647487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000863B888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000080DE308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087507C8>]}
2021-11-11 18:04:21.649487 (MainThread): Flushing usage events
2021-11-11 18:21:22.560210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:21:23.711210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 18:21:23.714210 (MainThread): Tracking: tracking
2021-11-11 18:21:23.715210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B595C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B59848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B59A08>]}
2021-11-11 18:21:23.737210 (MainThread): Partial parsing not enabled
2021-11-11 18:21:23.837210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:21:23.886210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:21:23.899210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:21:23.903210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:21:23.909210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:21:23.940210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:21:23.949210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:21:23.953210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:21:23.975210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:21:23.980210 (MainThread): Parsing macros\core.sql
2021-11-11 18:21:23.986210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:21:24.107210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:21:24.128210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:21:24.131210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:21:24.136210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:21:24.144210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:21:24.148210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:21:24.151210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:21:24.155210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:21:24.171210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:21:24.183210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:21:24.205210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:21:24.208210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:21:24.224210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:21:24.258210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:21:24.296210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:21:24.347210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:21:24.350210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:21:24.376210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:21:24.388210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:21:24.398210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:21:24.410210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:21:24.414210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:21:24.416210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:21:24.419210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:21:24.823210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:21:24.855210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:21:24.863210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:21:24.926210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c733d71e-febb-4024-aa2d-d05d885b5057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000866D688>]}
2021-11-11 18:21:24.940210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c733d71e-febb-4024-aa2d-d05d885b5057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086188C8>]}
2021-11-11 18:21:24.941210 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:21:24.943210 (MainThread): 
2021-11-11 18:21:24.944210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:21:24.946210 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 18:21:24.946210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:21:25.730210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:21:25.731210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:21:25.747210 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:21:26.364210 (MainThread): 12:21:26 | Concurrency: 1 threads (target='dev')
2021-11-11 18:21:26.365210 (MainThread): 12:21:26 | 
2021-11-11 18:21:26.378210 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 18:21:26.379210 (Thread-1): 12:21:26 | 1 of 2 START view model dbt_brooke.stg_customers..................... [RUN]
2021-11-11 18:21:26.380210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:21:26.381210 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 18:21:26.384210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:21:26.395210 (Thread-1): finished collecting timing info
2021-11-11 18:21:26.436210 (Thread-1): finished collecting timing info
2021-11-11 18:21:26.436210 (Thread-1): Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_customers (models\staging\stg_customers.sql)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1017, in inner
    raise exc
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 686, in relation_wrong_type
    model)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_customers (models\staging\stg_customers.sql)
2021-11-11 18:21:26.449210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c733d71e-febb-4024-aa2d-d05d885b5057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008618108>]}
2021-11-11 18:21:26.449210 (Thread-1): 12:21:26 | 1 of 2 ERROR creating view model dbt_brooke.stg_customers............ [ERROR in 0.07s]
2021-11-11 18:21:26.452210 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 18:21:26.452210 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 18:21:26.453210 (Thread-1): 12:21:26 | 2 of 2 START view model dbt_brooke.stg_orders........................ [RUN]
2021-11-11 18:21:26.454210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:21:26.454210 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 18:21:26.457210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:21:26.462210 (Thread-1): finished collecting timing info
2021-11-11 18:21:26.466210 (Thread-1): finished collecting timing info
2021-11-11 18:21:26.468210 (Thread-1): Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_orders (models\staging\stg_orders.sql)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1017, in inner
    raise exc
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 686, in relation_wrong_type
    model)
  File "c:\programdata\anaconda3\envs\dbt\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_orders (models\staging\stg_orders.sql)
2021-11-11 18:21:26.470210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c733d71e-febb-4024-aa2d-d05d885b5057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B80B08>]}
2021-11-11 18:21:26.471210 (Thread-1): 12:21:26 | 2 of 2 ERROR creating view model dbt_brooke.stg_orders............... [ERROR in 0.02s]
2021-11-11 18:21:26.475210 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 18:21:26.476210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:21:26.477210 (MainThread): 12:21:26 | 
2021-11-11 18:21:26.478210 (MainThread): 12:21:26 | Finished running 2 view models in 1.53s.
2021-11-11 18:21:26.479210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:21:26.479210 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 18:21:26.479210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:21:26.480210 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-11-11 18:21:26.493210 (MainThread): 
2021-11-11 18:21:26.494210 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-11 18:21:26.495210 (MainThread): 
2021-11-11 18:21:26.496210 (MainThread): Compilation Error in model stg_customers (models\staging\stg_customers.sql)
2021-11-11 18:21:26.497210 (MainThread):   Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-11-11 18:21:26.498210 (MainThread):   
2021-11-11 18:21:26.499210 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2021-11-11 18:21:26.500210 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2021-11-11 18:21:26.500210 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2021-11-11 18:21:26.502210 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2021-11-11 18:21:26.503210 (MainThread):   > called by model stg_customers (models\staging\stg_customers.sql)
2021-11-11 18:21:26.503210 (MainThread): 
2021-11-11 18:21:26.505210 (MainThread): Compilation Error in model stg_orders (models\staging\stg_orders.sql)
2021-11-11 18:21:26.506210 (MainThread):   Trying to create view `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`, but it currently exists as a table. Either drop `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-11-11 18:21:26.508210 (MainThread):   
2021-11-11 18:21:26.508210 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2021-11-11 18:21:26.509210 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2021-11-11 18:21:26.510210 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2021-11-11 18:21:26.511210 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2021-11-11 18:21:26.512210 (MainThread):   > called by model stg_orders (models\staging\stg_orders.sql)
2021-11-11 18:21:26.512210 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2021-11-11 18:21:26.514210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008807F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008807F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008807848>]}
2021-11-11 18:21:26.514210 (MainThread): Flushing usage events
2021-11-11 18:22:00.679210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:22:01.366210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 18:22:01.371210 (MainThread): Tracking: tracking
2021-11-11 18:22:01.372210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008552548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085527C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008552988>]}
2021-11-11 18:22:01.388210 (MainThread): Partial parsing not enabled
2021-11-11 18:22:01.433210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:22:01.468210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:22:01.477210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:22:01.480210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:22:01.484210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:22:01.505210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:22:01.510210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:22:01.512210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:22:01.526210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:22:01.531210 (MainThread): Parsing macros\core.sql
2021-11-11 18:22:01.536210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:22:01.618210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:22:01.630210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:22:01.633210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:22:01.635210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:22:01.639210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:22:01.641210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:22:01.643210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:22:01.645210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:22:01.660210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:22:01.670210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:22:01.691210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:22:01.694210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:22:01.709210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:22:01.742210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:22:01.784210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:22:01.850210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:22:01.853210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:22:01.886210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:22:01.901210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:22:01.907210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:22:01.929210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:22:01.933210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:22:01.935210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:22:01.938210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:22:02.285210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:22:02.306210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:22:02.311210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:22:02.357210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44a16fc0-dbcd-4fcd-9389-7877eceec4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000066D0208>]}
2021-11-11 18:22:02.377210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44a16fc0-dbcd-4fcd-9389-7877eceec4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000861F488>]}
2021-11-11 18:22:02.378210 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:22:02.380210 (MainThread): 
2021-11-11 18:22:02.381210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:22:02.383210 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521".
2021-11-11 18:22:02.384210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:22:03.038210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:22:03.039210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:22:03.054210 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:22:03.667210 (MainThread): 12:22:03 | Concurrency: 1 threads (target='dev')
2021-11-11 18:22:03.668210 (MainThread): 12:22:03 | 
2021-11-11 18:22:03.673210 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 18:22:03.675210 (Thread-1): 12:22:03 | 1 of 2 START view model dbt_brooke.stg_customers..................... [RUN]
2021-11-11 18:22:03.678210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:22:03.680210 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 18:22:03.683210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:22:03.692210 (Thread-1): finished collecting timing info
2021-11-11 18:22:03.731210 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:22:03.737210 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:22:07.469210 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:22:07.476210 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
  OPTIONS()
  as SELECT
id as customer_id
, first_name
, last_name

FROM `dbt-tutorial`.jaffle_shop.customers;


2021-11-11 18:22:08.747210 (Thread-1): finished collecting timing info
2021-11-11 18:22:08.750210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44a16fc0-dbcd-4fcd-9389-7877eceec4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085F1808>]}
2021-11-11 18:22:08.753210 (Thread-1): 12:22:08 | 1 of 2 OK created view model dbt_brooke.stg_customers................ [OK in 5.07s]
2021-11-11 18:22:08.757210 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 18:22:08.758210 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 18:22:08.760210 (Thread-1): 12:22:08 | 2 of 2 START view model dbt_brooke.stg_orders........................ [RUN]
2021-11-11 18:22:08.762210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:22:08.763210 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 18:22:08.768210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:22:08.786210 (Thread-1): finished collecting timing info
2021-11-11 18:22:08.793210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:22:08.808210 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:22:09.491210 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:22:09.506210 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
  OPTIONS()
  as SELECT
id as order_id
, user_id as customer_id
, order_date
, STATUS

FROM `dbt-tutorial`.jaffle_shop.orders;


2021-11-11 18:22:10.223210 (Thread-1): finished collecting timing info
2021-11-11 18:22:10.225210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44a16fc0-dbcd-4fcd-9389-7877eceec4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000869F548>]}
2021-11-11 18:22:10.226210 (Thread-1): 12:22:10 | 2 of 2 OK created view model dbt_brooke.stg_orders................... [OK in 1.46s]
2021-11-11 18:22:10.231210 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 18:22:10.277210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:22:10.278210 (MainThread): 12:22:10 | 
2021-11-11 18:22:10.280210 (MainThread): 12:22:10 | Finished running 2 view models in 7.90s.
2021-11-11 18:22:10.282210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:22:10.283210 (MainThread): Connection 'list_dbt-tutorial-331521' was properly closed.
2021-11-11 18:22:10.284210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:22:10.285210 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-11-11 18:22:10.334210 (MainThread): 
2021-11-11 18:22:10.335210 (MainThread): Completed successfully
2021-11-11 18:22:10.337210 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-11 18:22:10.338210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085C6F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086A81C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085E01C8>]}
2021-11-11 18:22:10.339210 (MainThread): Flushing usage events
2021-11-11 18:46:31.817210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:46:32.759210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-11-11 18:46:32.762210 (MainThread): Tracking: tracking
2021-11-11 18:46:32.763210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008549688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855BBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008549588>]}
2021-11-11 18:46:32.778210 (MainThread): Partial parsing not enabled
2021-11-11 18:46:32.849210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:46:32.884210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:46:32.894210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:46:32.897210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:46:32.900210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:46:32.923210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:46:32.927210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:46:32.929210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:46:32.944210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:46:32.947210 (MainThread): Parsing macros\core.sql
2021-11-11 18:46:32.953210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:46:33.059210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:46:33.075210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:46:33.078210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:46:33.081210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:46:33.086210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:46:33.090210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:46:33.092210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:46:33.096210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:46:33.116210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:46:33.130210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:46:33.158210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:46:33.162210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:46:33.182210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:46:33.220210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:46:33.263210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:46:33.324210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:46:33.327210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:46:33.362210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:46:33.373210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:46:33.382210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:46:33.395210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:46:33.399210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:46:33.400210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:46:33.403210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:46:33.796210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:46:33.817210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:46:33.821210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:46:33.950210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0202694b-e13f-4d15-b034-56188d141da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085DCB88>]}
2021-11-11 18:46:33.963210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0202694b-e13f-4d15-b034-56188d141da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085AB548>]}
2021-11-11 18:46:33.964210 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:46:33.967210 (MainThread): 
2021-11-11 18:46:33.968210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:46:33.970210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:46:33.971210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:46:33.984210 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:46:34.819210 (MainThread): 12:46:34 | Concurrency: 1 threads (target='dev')
2021-11-11 18:46:34.820210 (MainThread): 12:46:34 | 
2021-11-11 18:46:34.825210 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:46:34.825210 (Thread-1): 12:46:34 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-11-11 18:46:34.826210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-11-11 18:46:34.826210 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:46:34.839210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 18:46:34.850210 (Thread-1): finished collecting timing info
2021-11-11 18:46:34.889210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 18:46:34.901210 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:46:34.909210 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-11-11 18:46:37.683210 (Thread-1): finished collecting timing info
2021-11-11 18:46:37.686210 (Thread-1): 12:46:37 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 2.86s]
2021-11-11 18:46:37.692210 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:46:37.694210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:46:37.696210 (Thread-1): 12:46:37 | 2 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2021-11-11 18:46:37.699210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-11-11 18:46:37.700210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:46:37.716210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:46:37.727210 (Thread-1): finished collecting timing info
2021-11-11 18:46:37.730210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:46:37.734210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:37.741210 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:46:39.816210 (Thread-1): finished collecting timing info
2021-11-11 18:46:39.817210 (Thread-1): 12:46:39 | 2 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 2.12s]
2021-11-11 18:46:39.821210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:46:39.822210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-11-11 18:46:39.823210 (Thread-1): 12:46:39 | 3 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2021-11-11 18:46:39.824210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5".
2021-11-11 18:46:39.825210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-11-11 18:46:39.827210 (Thread-1): unclosed <socket.socket fd=872, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50400), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:39.828210 (Thread-1): unclosed <socket.socket fd=884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50401), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:39.836210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2021-11-11 18:46:39.840210 (Thread-1): finished collecting timing info
2021-11-11 18:46:39.842210 (Thread-1): unclosed <socket.socket fd=820, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50398), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:39.842210 (Thread-1): unclosed <socket.socket fd=832, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50399), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:39.847210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2021-11-11 18:46:39.851210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:39.859210 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:46:42.047210 (Thread-1): finished collecting timing info
2021-11-11 18:46:42.048210 (Thread-1): 12:46:42 | 3 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 2.22s]
2021-11-11 18:46:42.050210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-11-11 18:46:42.050210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:46:42.051210 (Thread-1): 12:46:42 | 4 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2021-11-11 18:46:42.052210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-11-11 18:46:42.052210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:46:42.057210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:46:42.060210 (Thread-1): finished collecting timing info
2021-11-11 18:46:42.062210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:46:42.066210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:42.072210 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2021-11-11 18:46:44.253210 (Thread-1): finished collecting timing info
2021-11-11 18:46:44.254210 (Thread-1): 12:46:44 | 4 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 2.20s]
2021-11-11 18:46:44.258210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:46:44.259210 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-11-11 18:46:44.260210 (Thread-1): 12:46:44 | 5 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-11-11 18:46:44.262210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-11-11 18:46:44.263210 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-11-11 18:46:44.266210 (Thread-1): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50404), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:44.267210 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50405), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:44.278210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-11-11 18:46:44.282210 (Thread-1): finished collecting timing info
2021-11-11 18:46:44.284210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-11-11 18:46:44.288210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:44.295210 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-11-11 18:46:46.197210 (Thread-1): finished collecting timing info
2021-11-11 18:46:46.198210 (Thread-1): 12:46:46 | 5 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.94s]
2021-11-11 18:46:46.200210 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-11-11 18:46:46.201210 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:46:46.202210 (Thread-1): 12:46:46 | 6 of 9 START test unique_stg_customers_customer_id................... [RUN]
2021-11-11 18:46:46.203210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-11-11 18:46:46.203210 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:46:46.216210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:46:46.220210 (Thread-1): finished collecting timing info
2021-11-11 18:46:46.223210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:46:46.226210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:46.233210 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:46:48.260210 (Thread-1): finished collecting timing info
2021-11-11 18:46:48.261210 (Thread-1): 12:46:48 | 6 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 2.06s]
2021-11-11 18:46:48.264210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:46:48.264210 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:46:48.265210 (Thread-1): 12:46:48 | 7 of 9 START test unique_stg_orders_order_id......................... [RUN]
2021-11-11 18:46:48.267210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-11-11 18:46:48.267210 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:46:48.280210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:46:48.285210 (Thread-1): finished collecting timing info
2021-11-11 18:46:48.289210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:46:48.295210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:48.302210 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:46:50.681210 (Thread-1): finished collecting timing info
2021-11-11 18:46:50.683210 (Thread-1): 12:46:50 | 7 of 9 PASS unique_stg_orders_order_id............................... [PASS in 2.42s]
2021-11-11 18:46:50.689210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:46:50.693210 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:46:50.694210 (Thread-1): 12:46:50 | 8 of 9 START test not_null_customers_customer_id..................... [RUN]
2021-11-11 18:46:50.696210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-11-11 18:46:50.697210 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:46:50.699210 (Thread-1): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50411), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:50.700210 (Thread-1): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50412), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:50.711210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 18:46:50.717210 (Thread-1): finished collecting timing info
2021-11-11 18:46:50.721210 (Thread-1): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50402), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:50.722210 (Thread-1): unclosed <socket.socket fd=916, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50403), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:50.726210 (Thread-1): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50407), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:50.727210 (Thread-1): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50406), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:50.728210 (Thread-1): unclosed <socket.socket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50409), raddr=('172.217.4.42', 443)>
2021-11-11 18:46:50.728210 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50410), raddr=('142.250.190.10', 443)>
2021-11-11 18:46:50.733210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 18:46:50.735210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:50.741210 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:46:52.649210 (Thread-1): finished collecting timing info
2021-11-11 18:46:52.650210 (Thread-1): 12:46:52 | 8 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.95s]
2021-11-11 18:46:52.654210 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:46:52.655210 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:46:52.656210 (Thread-1): 12:46:52 | 9 of 9 START test unique_customers_customer_id....................... [RUN]
2021-11-11 18:46:52.659210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-11-11 18:46:52.660210 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:46:52.670210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 18:46:52.676210 (Thread-1): finished collecting timing info
2021-11-11 18:46:52.678210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 18:46:52.681210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:46:52.687210 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:46:56.426210 (Thread-1): finished collecting timing info
2021-11-11 18:46:56.428210 (Thread-1): 12:46:56 | 9 of 9 PASS unique_customers_customer_id............................. [PASS in 3.77s]
2021-11-11 18:46:56.431210 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:46:56.528210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:46:56.529210 (MainThread): 12:46:56 | 
2021-11-11 18:46:56.531210 (MainThread): 12:46:56 | Finished running 9 tests in 22.56s.
2021-11-11 18:46:56.532210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:46:56.533210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:46:56.533210 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-11-11 18:46:56.556210 (MainThread): 
2021-11-11 18:46:56.556210 (MainThread): Completed successfully
2021-11-11 18:46:56.558210 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2021-11-11 18:46:56.558210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007ADFE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007ADF388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007AAC488>]}
2021-11-11 18:46:56.559210 (MainThread): Flushing usage events
2021-11-11 18:50:42.580210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:50:43.265210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-11-11 18:50:43.267210 (MainThread): Tracking: tracking
2021-11-11 18:50:43.268210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000043291C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007A7EA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B675C8>]}
2021-11-11 18:50:43.283210 (MainThread): Partial parsing not enabled
2021-11-11 18:50:43.339210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:50:43.373210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:50:43.382210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:50:43.385210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:50:43.389210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:50:43.410210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:50:43.414210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:50:43.416210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:50:43.430210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:50:43.434210 (MainThread): Parsing macros\core.sql
2021-11-11 18:50:43.439210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:50:43.536210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:50:43.549210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:50:43.552210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:50:43.554210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:50:43.559210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:50:43.561210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:50:43.562210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:50:43.565210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:50:43.584210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:50:43.597210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:50:43.617210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:50:43.620210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:50:43.636210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:50:43.666210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:50:43.701210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:50:43.751210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:50:43.754210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:50:43.780210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:50:43.791210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:50:43.797210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:50:43.807210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:50:43.811210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:50:43.812210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:50:43.815210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:50:44.147210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:50:44.166210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:50:44.172210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:50:44.279210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac52a2f9-cb3f-4e07-9186-49c07852ae22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B62348>]}
2021-11-11 18:50:44.292210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac52a2f9-cb3f-4e07-9186-49c07852ae22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000864E3C8>]}
2021-11-11 18:50:44.292210 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:50:44.294210 (MainThread): 
2021-11-11 18:50:44.295210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:50:44.296210 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:50:44.297210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 18:50:44.307210 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:50:44.885210 (MainThread): 12:50:44 | Concurrency: 1 threads (target='dev')
2021-11-11 18:50:44.887210 (MainThread): 12:50:44 | 
2021-11-11 18:50:44.897210 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 18:50:44.898210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:50:44.899210 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 18:50:44.905210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 18:50:44.911210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.912210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.912210 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 18:50:44.913210 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 18:50:44.914210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:50:44.914210 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 18:50:44.916210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 18:50:44.921210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.922210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.922210 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 18:50:44.923210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:50:44.924210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-11-11 18:50:44.924210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:50:44.942210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:50:44.948210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.948210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.949210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:50:44.949210 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:50:44.950210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-11-11 18:50:44.950210 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:50:44.960210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:50:44.967210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.967210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.968210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:50:44.968210 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:50:44.970210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-11-11 18:50:44.971210 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:50:44.982210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 18:50:44.986210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.987210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.987210 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:50:44.988210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:50:44.988210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-11-11 18:50:44.989210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:50:44.993210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:50:44.996210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.996210 (Thread-1): finished collecting timing info
2021-11-11 18:50:44.997210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:50:44.997210 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:50:44.998210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-11-11 18:50:44.998210 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:50:45.002210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:50:45.005210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.006210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.006210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:50:45.007210 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 18:50:45.007210 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:50:45.007210 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-11 18:50:45.011210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-11 18:50:45.016210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.016210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.017210 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 18:50:45.017210 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:50:45.018210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-11-11 18:50:45.018210 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:50:45.022210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 18:50:45.025210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.025210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.026210 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:50:45.026210 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:50:45.027210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-11-11 18:50:45.027210 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:50:45.032210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 18:50:45.035210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.036210 (Thread-1): finished collecting timing info
2021-11-11 18:50:45.036210 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:50:45.094210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:50:45.094210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:50:45.095210 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-11-11 18:50:45.113210 (MainThread): 12:50:45 | Done.
2021-11-11 18:50:45.134210 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-11-11 18:50:45.134210 (MainThread): 12:50:45 | Building catalog
2021-11-11 18:50:45.137210 (MainThread): Opening a new connection, currently in state init
2021-11-11 18:50:45.756210 (MainThread): Skipping catalog for dbt-tutorial-331521.dbt_brooke_dbt_test__audit - schema does not exist
2021-11-11 18:50:45.757210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial-331521.information_schema".
2021-11-11 18:50:45.787210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:50:45.795210 (ThreadPoolExecutor-1_0): On dbt-tutorial-331521.information_schema: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "connection_name": "dbt-tutorial-331521.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial-331521`.`dbt_brooke`.__TABLES__
        where (upper(dataset_id) = upper('dbt_brooke'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial-331521`.`dbt_brooke`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial-331521`.`dbt_brooke`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-11-11 18:50:50.603210 (MainThread): 12:50:50 | Catalog written to C:\dbt\jaffle-shop\target\catalog.json
2021-11-11 18:50:50.604210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000080D42C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085AF248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085E6CC8>]}
2021-11-11 18:50:50.605210 (MainThread): Flushing usage events
2021-11-11 18:50:51.054210 (MainThread): Connection 'generate_catalog' was properly closed.
2021-11-11 18:50:51.055210 (MainThread): Connection 'dbt-tutorial-331521.information_schema' was properly closed.
2021-11-11 18:50:59.914210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:51:00.630210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-11-11 18:51:00.632210 (MainThread): Tracking: tracking
2021-11-11 18:51:00.633210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B73648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004374988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B64908>]}
2021-11-11 18:51:00.640210 (MainThread): Serving docs at 0.0.0.0:8080
2021-11-11 18:51:00.641210 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-11-11 18:51:00.642210 (MainThread): Press Ctrl+C to exit.


2021-11-11 18:53:59.913210 (MainThread): Flushing usage events
2021-11-11 18:54:00.374210 (MainThread): ctrl-c
2021-11-11 18:54:09.445210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:54:10.213210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-11-11 18:54:10.215210 (MainThread): Tracking: tracking
2021-11-11 18:54:10.216210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855C548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855BE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000855C448>]}
2021-11-11 18:54:10.232210 (MainThread): Partial parsing not enabled
2021-11-11 18:54:10.304210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:54:10.337210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:54:10.346210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:54:10.350210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:54:10.354210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:54:10.384210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:54:10.391210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:54:10.395210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:54:10.414210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:54:10.418210 (MainThread): Parsing macros\core.sql
2021-11-11 18:54:10.424210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:54:10.511210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:54:10.528210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:54:10.531210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:54:10.534210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:54:10.537210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:54:10.540210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:54:10.542210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:54:10.545210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:54:10.562210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:54:10.574210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:54:10.601210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:54:10.605210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:54:10.631210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:54:10.669210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:54:10.723210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:54:10.779210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:54:10.782210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:54:10.813210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:54:10.826210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:54:10.838210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:54:10.853210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:54:10.859210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:54:10.862210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:54:10.865210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:54:11.205210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:54:11.225210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:54:11.229210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:54:11.326210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3b8fa8-bd73-4cd1-aba6-ea8752ab26d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B77088>]}
2021-11-11 18:54:11.338210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3b8fa8-bd73-4cd1-aba6-ea8752ab26d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000865E4C8>]}
2021-11-11 18:54:11.339210 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:54:11.341210 (MainThread): 
2021-11-11 18:54:11.342210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:54:11.344210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:54:11.344210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:54:11.355210 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:54:12.138210 (MainThread): 12:54:12 | Concurrency: 1 threads (target='dev')
2021-11-11 18:54:12.139210 (MainThread): 12:54:12 | 
2021-11-11 18:54:12.153210 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5
2021-11-11 18:54:12.153210 (Thread-1): 12:54:12 | 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending [RUN]
2021-11-11 18:54:12.154210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5".
2021-11-11 18:54:12.157210 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5
2021-11-11 18:54:12.180210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5"
2021-11-11 18:54:12.197210 (Thread-1): finished collecting timing info
2021-11-11 18:54:12.335210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5"
2021-11-11 18:54:12.363210 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:54:12.379210 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending'
)



      
    ) dbt_internal_test
2021-11-11 18:54:14.114210 (Thread-1): finished collecting timing info
2021-11-11 18:54:14.115210 (Thread-1): 12:54:14 | 1 of 7 FAIL 1 accepted_values_stg_orders_status__placed__shipped__completed__return_pending [FAIL 1 in 1.96s]
2021-11-11 18:54:14.117210 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending.53fa0900e5
2021-11-11 18:54:14.117210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:54:14.118210 (Thread-1): 12:54:14 | 2 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2021-11-11 18:54:14.119210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-11-11 18:54:14.119210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:54:14.132210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:54:14.136210 (Thread-1): finished collecting timing info
2021-11-11 18:54:14.139210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:54:14.143210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:14.150210 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:54:15.578210 (Thread-1): finished collecting timing info
2021-11-11 18:54:15.578210 (Thread-1): 12:54:15 | 2 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.46s]
2021-11-11 18:54:15.580210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:54:15.581210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:54:15.581210 (Thread-1): 12:54:15 | 3 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2021-11-11 18:54:15.582210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-11-11 18:54:15.583210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:54:15.584210 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50621), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:15.584210 (Thread-1): unclosed <socket.socket fd=860, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50622), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:15.592210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:54:15.596210 (Thread-1): finished collecting timing info
2021-11-11 18:54:15.599210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:54:15.603210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:15.611210 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2021-11-11 18:54:17.522210 (Thread-1): finished collecting timing info
2021-11-11 18:54:17.523210 (Thread-1): 12:54:17 | 3 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.94s]
2021-11-11 18:54:17.524210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:54:17.525210 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:54:17.525210 (Thread-1): 12:54:17 | 4 of 7 START test unique_stg_customers_customer_id................... [RUN]
2021-11-11 18:54:17.526210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-11-11 18:54:17.527210 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:54:17.532210 (Thread-1): unclosed <socket.socket fd=800, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50617), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:17.532210 (Thread-1): unclosed <socket.socket fd=812, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50619), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:17.537210 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50623), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:17.537210 (Thread-1): unclosed <socket.socket fd=892, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50624), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:17.546210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:54:17.551210 (Thread-1): finished collecting timing info
2021-11-11 18:54:17.556210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:54:17.561210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:17.569210 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:54:19.059210 (Thread-1): finished collecting timing info
2021-11-11 18:54:19.060210 (Thread-1): 12:54:19 | 4 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.53s]
2021-11-11 18:54:19.062210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:54:19.062210 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:54:19.063210 (Thread-1): 12:54:19 | 5 of 7 START test unique_stg_orders_order_id......................... [RUN]
2021-11-11 18:54:19.064210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-11-11 18:54:19.065210 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:54:19.068210 (Thread-1): unclosed <socket.socket fd=916, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50626), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:19.069210 (Thread-1): unclosed <socket.socket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50627), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:19.078210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:54:19.086210 (Thread-1): finished collecting timing info
2021-11-11 18:54:19.090210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:54:19.096210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:19.106210 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:54:20.720210 (Thread-1): finished collecting timing info
2021-11-11 18:54:20.721210 (Thread-1): 12:54:20 | 5 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.66s]
2021-11-11 18:54:20.722210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:54:20.723210 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:54:20.724210 (Thread-1): 12:54:20 | 6 of 7 START test not_null_customers_customer_id..................... [RUN]
2021-11-11 18:54:20.725210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-11-11 18:54:20.725210 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:54:20.726210 (Thread-1): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50628), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:20.727210 (Thread-1): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50629), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:20.734210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 18:54:20.740210 (Thread-1): finished collecting timing info
2021-11-11 18:54:20.743210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 18:54:20.747210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:20.756210 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:54:22.920210 (Thread-1): finished collecting timing info
2021-11-11 18:54:22.920210 (Thread-1): 12:54:22 | 6 of 7 PASS not_null_customers_customer_id........................... [PASS in 2.19s]
2021-11-11 18:54:22.922210 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 18:54:22.922210 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:54:22.923210 (Thread-1): 12:54:22 | 7 of 7 START test unique_customers_customer_id....................... [RUN]
2021-11-11 18:54:22.924210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-11-11 18:54:22.924210 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:54:22.930210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 18:54:22.934210 (Thread-1): finished collecting timing info
2021-11-11 18:54:22.937210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 18:54:22.940210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:54:22.948210 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:54:25.602210 (Thread-1): finished collecting timing info
2021-11-11 18:54:25.603210 (Thread-1): 12:54:25 | 7 of 7 PASS unique_customers_customer_id............................. [PASS in 2.68s]
2021-11-11 18:54:25.605210 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 18:54:25.671210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:54:25.672210 (MainThread): 12:54:25 | 
2021-11-11 18:54:25.673210 (MainThread): 12:54:25 | Finished running 7 tests in 14.33s.
2021-11-11 18:54:25.674210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:54:25.674210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:54:25.674210 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-11-11 18:54:25.676210 (MainThread): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50634), raddr=('142.250.190.74', 443)>
2021-11-11 18:54:25.676210 (MainThread): unclosed <socket.socket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50636), raddr=('142.251.32.10', 443)>
2021-11-11 18:54:25.691210 (MainThread): 
2021-11-11 18:54:25.692210 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 18:54:25.693210 (MainThread): 
2021-11-11 18:54:25.694210 (MainThread): Failure in test accepted_values_stg_orders_status__placed__shipped__completed__return_pending (models\schema.yml)
2021-11-11 18:54:25.697210 (MainThread):   Got 1 result, configured to fail if != 0
2021-11-11 18:54:25.698210 (MainThread): 
2021-11-11 18:54:25.698210 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\accepted_values_stg_orders_62d7846404b81142bf3afb7b27ee2a82.sql
2021-11-11 18:54:25.699210 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-11 18:54:25.700210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008AAF408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000866B448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000087820C8>]}
2021-11-11 18:54:25.701210 (MainThread): Flushing usage events
2021-11-11 18:56:32.911210 (MainThread): Running with dbt=0.21.0
2021-11-11 18:56:33.622210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['staging'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-11-11 18:56:33.624210 (MainThread): Tracking: tracking
2021-11-11 18:56:33.625210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000084C95C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000007ADFE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000084C9A08>]}
2021-11-11 18:56:33.642210 (MainThread): Partial parsing not enabled
2021-11-11 18:56:33.689210 (MainThread): Parsing macros\adapters.sql
2021-11-11 18:56:33.726210 (MainThread): Parsing macros\catalog.sql
2021-11-11 18:56:33.736210 (MainThread): Parsing macros\etc.sql
2021-11-11 18:56:33.739210 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 18:56:33.743210 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 18:56:33.765210 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 18:56:33.771210 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 18:56:33.774210 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 18:56:33.789210 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 18:56:33.793210 (MainThread): Parsing macros\core.sql
2021-11-11 18:56:33.801210 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 18:56:33.904210 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 18:56:33.918210 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 18:56:33.920210 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 18:56:33.923210 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 18:56:33.926210 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 18:56:33.929210 (MainThread): Parsing macros\etc\query.sql
2021-11-11 18:56:33.930210 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 18:56:33.934210 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 18:56:33.950210 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 18:56:33.960210 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 18:56:33.983210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 18:56:33.986210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 18:56:34.002210 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 18:56:34.033210 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 18:56:34.076210 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 18:56:34.134210 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 18:56:34.138210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 18:56:34.166210 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 18:56:34.178210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 18:56:34.185210 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 18:56:34.196210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 18:56:34.200210 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 18:56:34.202210 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 18:56:34.205210 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 18:56:34.561210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 18:56:34.587210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 18:56:34.592210 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 18:56:34.721210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b0f8244-93b8-4bcb-a8d0-d7aae951c1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000854E488>]}
2021-11-11 18:56:34.737210 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b0f8244-93b8-4bcb-a8d0-d7aae951c1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008666E88>]}
2021-11-11 18:56:34.738210 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 18:56:34.740210 (MainThread): 
2021-11-11 18:56:34.741210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:56:34.742210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 18:56:34.743210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 18:56:34.754210 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 18:56:36.017210 (MainThread): 12:56:36 | Concurrency: 1 threads (target='dev')
2021-11-11 18:56:36.019210 (MainThread): 12:56:36 | 
2021-11-11 18:56:36.026210 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:56:36.027210 (Thread-1): 12:56:36 | 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-11-11 18:56:36.028210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-11-11 18:56:36.029210 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:56:36.059210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 18:56:36.070210 (Thread-1): finished collecting timing info
2021-11-11 18:56:36.107210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 18:56:36.113210 (Thread-1): Opening a new connection, currently in state init
2021-11-11 18:56:36.119210 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-11-11 18:56:39.438210 (Thread-1): finished collecting timing info
2021-11-11 18:56:39.439210 (Thread-1): 12:56:39 | 1 of 5 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 3.41s]
2021-11-11 18:56:39.442210 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 18:56:39.442210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:56:39.443210 (Thread-1): 12:56:39 | 2 of 5 START test not_null_stg_customers_customer_id................. [RUN]
2021-11-11 18:56:39.445210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-11-11 18:56:39.446210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:56:39.462210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:56:39.470210 (Thread-1): finished collecting timing info
2021-11-11 18:56:39.476210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 18:56:39.480210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:56:39.486210 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2021-11-11 18:56:41.002210 (Thread-1): finished collecting timing info
2021-11-11 18:56:41.003210 (Thread-1): 12:56:41 | 2 of 5 PASS not_null_stg_customers_customer_id....................... [PASS in 1.56s]
2021-11-11 18:56:41.005210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 18:56:41.006210 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:56:41.007210 (Thread-1): 12:56:41 | 3 of 5 START test not_null_stg_orders_order_id....................... [RUN]
2021-11-11 18:56:41.008210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-11-11 18:56:41.010210 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:56:41.012210 (Thread-1): unclosed <socket.socket fd=852, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50694), raddr=('142.250.190.74', 443)>
2021-11-11 18:56:41.012210 (Thread-1): unclosed <socket.socket fd=864, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50696), raddr=('142.251.32.10', 443)>
2021-11-11 18:56:41.020210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:56:41.024210 (Thread-1): finished collecting timing info
2021-11-11 18:56:41.030210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 18:56:41.036210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:56:41.043210 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2021-11-11 18:56:42.815210 (Thread-1): finished collecting timing info
2021-11-11 18:56:42.816210 (Thread-1): 12:56:42 | 3 of 5 PASS not_null_stg_orders_order_id............................. [PASS in 1.81s]
2021-11-11 18:56:42.818210 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 18:56:42.819210 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:56:42.820210 (Thread-1): 12:56:42 | 4 of 5 START test unique_stg_customers_customer_id................... [RUN]
2021-11-11 18:56:42.821210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-11-11 18:56:42.822210 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:56:42.832210 (Thread-1): unclosed <socket.socket fd=804, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50691), raddr=('142.250.190.74', 443)>
2021-11-11 18:56:42.834210 (Thread-1): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50692), raddr=('142.251.32.10', 443)>
2021-11-11 18:56:42.837210 (Thread-1): unclosed <socket.socket fd=884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50697), raddr=('142.250.190.74', 443)>
2021-11-11 18:56:42.837210 (Thread-1): unclosed <socket.socket fd=896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50698), raddr=('142.251.32.10', 443)>
2021-11-11 18:56:42.845210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:56:42.847210 (Thread-1): finished collecting timing info
2021-11-11 18:56:42.850210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 18:56:42.852210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:56:42.859210 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:56:44.694210 (Thread-1): finished collecting timing info
2021-11-11 18:56:44.695210 (Thread-1): 12:56:44 | 4 of 5 PASS unique_stg_customers_customer_id......................... [PASS in 1.87s]
2021-11-11 18:56:44.697210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 18:56:44.698210 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:56:44.698210 (Thread-1): 12:56:44 | 5 of 5 START test unique_stg_orders_order_id......................... [RUN]
2021-11-11 18:56:44.700210 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-11-11 18:56:44.701210 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:56:44.702210 (Thread-1): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50699), raddr=('142.250.190.74', 443)>
2021-11-11 18:56:44.703210 (Thread-1): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.180.148', 50700), raddr=('142.251.32.10', 443)>
2021-11-11 18:56:44.714210 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:56:44.721210 (Thread-1): finished collecting timing info
2021-11-11 18:56:44.730210 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 18:56:44.736210 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 18:56:44.745210 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `dbt-tutorial-331521`.`dbt_brooke`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-11 18:56:46.680210 (Thread-1): finished collecting timing info
2021-11-11 18:56:46.681210 (Thread-1): 12:56:46 | 5 of 5 PASS unique_stg_orders_order_id............................... [PASS in 1.98s]
2021-11-11 18:56:46.682210 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 18:56:46.823210 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 18:56:46.824210 (MainThread): 12:56:46 | 
2021-11-11 18:56:46.825210 (MainThread): 12:56:46 | Finished running 5 tests in 12.08s.
2021-11-11 18:56:46.825210 (MainThread): Connection 'master' was properly closed.
2021-11-11 18:56:46.826210 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 18:56:46.826210 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
2021-11-11 18:56:46.852210 (MainThread): 
2021-11-11 18:56:46.853210 (MainThread): Completed successfully
2021-11-11 18:56:46.855210 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-11 18:56:46.856210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000864C988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000879A688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000877F648>]}
2021-11-11 18:56:46.858210 (MainThread): Flushing usage events
2021-11-11 19:01:50.736217 (MainThread): Running with dbt=0.21.0
2021-11-11 19:01:51.914335 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-11-11 19:01:51.918335 (MainThread): Tracking: tracking
2021-11-11 19:01:51.919335 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B5D488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B5D7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004B5D648>]}
2021-11-11 19:01:51.937337 (MainThread): Partial parsing not enabled
2021-11-11 19:01:52.041347 (MainThread): Parsing macros\adapters.sql
2021-11-11 19:01:52.098353 (MainThread): Parsing macros\catalog.sql
2021-11-11 19:01:52.111354 (MainThread): Parsing macros\etc.sql
2021-11-11 19:01:52.115355 (MainThread): Parsing macros\materializations\copy.sql
2021-11-11 19:01:52.121355 (MainThread): Parsing macros\materializations\incremental.sql
2021-11-11 19:01:52.154359 (MainThread): Parsing macros\materializations\seed.sql
2021-11-11 19:01:52.161359 (MainThread): Parsing macros\materializations\snapshot.sql
2021-11-11 19:01:52.165360 (MainThread): Parsing macros\materializations\table.sql
2021-11-11 19:01:52.190362 (MainThread): Parsing macros\materializations\view.sql
2021-11-11 19:01:52.197363 (MainThread): Parsing macros\core.sql
2021-11-11 19:01:52.206364 (MainThread): Parsing macros\adapters\common.sql
2021-11-11 19:01:52.327376 (MainThread): Parsing macros\etc\datetime.sql
2021-11-11 19:01:52.344378 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-11-11 19:01:52.348378 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-11-11 19:01:52.352378 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-11-11 19:01:52.358379 (MainThread): Parsing macros\etc\is_incremental.sql
2021-11-11 19:01:52.361379 (MainThread): Parsing macros\etc\query.sql
2021-11-11 19:01:52.363380 (MainThread): Parsing macros\etc\where_subquery.sql
2021-11-11 19:01:52.366380 (MainThread): Parsing macros\materializations\helpers.sql
2021-11-11 19:01:52.396383 (MainThread): Parsing macros\materializations\test.sql
2021-11-11 19:01:52.412384 (MainThread): Parsing macros\materializations\common\merge.sql
2021-11-11 19:01:52.450388 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-11-11 19:01:52.456389 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-11-11 19:01:52.481391 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2021-11-11 19:01:52.531396 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-11-11 19:01:52.594403 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-11-11 19:01:52.746418 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-11-11 19:01:52.751418 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-11-11 19:01:52.804424 (MainThread): Parsing macros\materializations\table\table.sql
2021-11-11 19:01:52.825426 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-11-11 19:01:52.836427 (MainThread): Parsing macros\materializations\view\view.sql
2021-11-11 19:01:52.858429 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-11-11 19:01:52.864430 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-11-11 19:01:52.868430 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-11-11 19:01:52.872430 (MainThread): Parsing macros\schema_tests\unique.sql
2021-11-11 19:01:53.439487 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 19:01:53.462489 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 19:01:53.466490 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 19:01:53.567500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e75420b9-e948-4b2b-b320-7196839a366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008559B88>]}
2021-11-11 19:01:53.582501 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e75420b9-e948-4b2b-b320-7196839a366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000008643948>]}
2021-11-11 19:01:53.583502 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 19:01:53.585502 (MainThread): 
2021-11-11 19:01:53.585502 (MainThread): Acquiring new bigquery connection "master".
2021-11-11 19:01:53.586502 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbt-tutorial-331521_dbt_brooke".
2021-11-11 19:01:53.587502 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 19:01:53.607504 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-11-11 19:01:58.727016 (MainThread): 13:01:58 | Concurrency: 1 threads (target='dev')
2021-11-11 19:01:58.728016 (MainThread): 13:01:58 | 
2021-11-11 19:01:58.733016 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-11-11 19:01:58.737017 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-11-11 19:01:58.738017 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-11-11 19:01:58.741017 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-11-11 19:01:58.749018 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.749018 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.750018 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-11-11 19:01:58.753018 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-11-11 19:01:58.755019 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-11-11 19:01:58.756019 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-11-11 19:01:58.759019 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-11-11 19:01:58.765020 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.766020 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.767020 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-11-11 19:01:58.767020 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 19:01:58.769020 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-11-11 19:01:58.770020 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 19:01:58.797023 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-11-11 19:01:58.805024 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.806024 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.807024 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-11-11 19:01:58.808024 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 19:01:58.809024 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-11-11 19:01:58.809024 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 19:01:58.832026 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-11-11 19:01:58.838027 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.839027 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.840027 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-11-11 19:01:58.840027 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 19:01:58.841027 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-11-11 19:01:58.842027 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 19:01:58.860029 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-11-11 19:01:58.866030 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.867030 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.869030 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-11-11 19:01:58.869030 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 19:01:58.870030 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-11-11 19:01:58.871030 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 19:01:58.881031 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-11-11 19:01:58.889032 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.890032 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.891032 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-11-11 19:01:58.892032 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 19:01:58.893032 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-11-11 19:01:58.893032 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 19:01:58.903033 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-11-11 19:01:58.908034 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.909034 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.910034 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-11-11 19:01:58.911034 (Thread-1): Began running node model.jaffle_shop.customers
2021-11-11 19:01:58.912034 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-11-11 19:01:58.912034 (Thread-1): Compiling model.jaffle_shop.customers
2021-11-11 19:01:58.922035 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-11-11 19:01:58.932036 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.936037 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.937037 (Thread-1): Finished running node model.jaffle_shop.customers
2021-11-11 19:01:58.938037 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 19:01:58.939037 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-11-11 19:01:58.940037 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 19:01:58.947038 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-11-11 19:01:58.954039 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.955039 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.956039 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-11-11 19:01:58.957039 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 19:01:58.958039 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-11-11 19:01:58.958039 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 19:01:58.967040 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-11-11 19:01:58.974041 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.975041 (Thread-1): finished collecting timing info
2021-11-11 19:01:58.976041 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-11-11 19:01:59.039047 (MainThread): Connection 'master' was properly closed.
2021-11-11 19:01:59.039047 (MainThread): Connection 'list_dbt-tutorial-331521_dbt_brooke' was properly closed.
2021-11-11 19:01:59.040047 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-11-11 19:01:59.055049 (MainThread): 13:01:59 | Done.
2021-11-11 19:01:59.080051 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-11-11 19:01:59.080051 (MainThread): 13:01:59 | Building catalog
2021-11-11 19:01:59.084052 (MainThread): Opening a new connection, currently in state init
2021-11-11 19:02:03.902533 (MainThread): Skipping catalog for dbt-tutorial-331521.dbt_brooke_dbt_test__audit - schema does not exist
2021-11-11 19:02:03.903533 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial-331521.information_schema".
2021-11-11 19:02:03.923535 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-11 19:02:03.929536 (ThreadPoolExecutor-1_0): On dbt-tutorial-331521.information_schema: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle-shop", "target_name": "dev", "connection_name": "dbt-tutorial-331521.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial-331521`.`dbt_brooke`.__TABLES__
        where (upper(dataset_id) = upper('dbt_brooke'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial-331521`.`dbt_brooke`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial-331521`.`dbt_brooke`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-11-11 19:02:07.355879 (MainThread): 13:02:07 | Catalog written to C:\dbt\jaffle-shop\target\catalog.json
2021-11-11 19:02:07.356879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085FFA08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000085FFD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000086DDF08>]}
2021-11-11 19:02:07.356879 (MainThread): Flushing usage events
2021-11-11 19:02:07.838927 (MainThread): Connection 'generate_catalog' was properly closed.
2021-11-11 19:02:07.839927 (MainThread): Connection 'dbt-tutorial-331521.information_schema' was properly closed.
2021-11-11 19:02:32.585401 (MainThread): Running with dbt=0.21.0
2021-11-11 19:02:33.185461 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\bm30588\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-11-11 19:02:33.187462 (MainThread): Tracking: tracking
2021-11-11 19:02:33.188462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000000004374648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000000000432E588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000000084D6988>]}
2021-11-11 19:02:33.198463 (MainThread): Serving docs at 0.0.0.0:8080
2021-11-11 19:02:33.199463 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-11-11 19:02:33.199463 (MainThread): Press Ctrl+C to exit.


2021-11-11 19:03:42.589401 (MainThread): Flushing usage events
2021-11-11 19:03:43.033445 (MainThread): ctrl-c
